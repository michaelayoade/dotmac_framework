Run started:2025-09-05 20:36:26.561915

Test results:
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac/__init__.py:14:4
13	        importlib.import_module(f"{__name__}.{subpkg}")
14	    except Exception:
15	        # Leave it to consumers to handle; this only aids import-time availability
16	        pass
17	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'jwt_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac/secrets/__init__.py:23:17
22	class SecretType(str, Enum):
23	    JWT_SECRET = "jwt_secret"
24	    DATABASE_CREDENTIAL = "database_credential"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'oauth_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac/secrets/__init__.py:27:19
26	    ENCRYPTION_KEY = "encryption_key"
27	    OAUTH_SECRET = "oauth_secret"
28	    WEBHOOK_SECRET = "webhook_secret"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'webhook_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac/secrets/__init__.py:28:21
27	    OAUTH_SECRET = "oauth_secret"
28	    WEBHOOK_SECRET = "webhook_secret"
29	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:64:8
63	
64	        assert result["status"] == "workflow_started"
65	        assert result["invoice"]["total_amount"] == Decimal("165.00")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:65:8
64	        assert result["status"] == "workflow_started"
65	        assert result["invoice"]["total_amount"] == Decimal("165.00")
66	        mock_task_queue.enqueue.assert_called_once()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:107:8
106	
107	        assert len(result["scheduled_tasks"]) == 3
108	        assert result["status"] == "scheduled"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:108:8
107	        assert len(result["scheduled_tasks"]) == 3
108	        assert result["status"] == "scheduled"
109	        assert mock_task_queue.enqueue.call_count == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:109:8
108	        assert result["status"] == "scheduled"
109	        assert mock_task_queue.enqueue.call_count == 3
110	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:165:8
164	
165	        assert result["file_id"] == "file-123"
166	        assert "INV-001" in result["filename"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:166:8
165	        assert result["file_id"] == "file-123"
166	        assert "INV-001" in result["filename"]
167	        assert result["size"] > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:167:8
166	        assert "INV-001" in result["filename"]
167	        assert result["size"] > 0
168	        mock_file_storage.upload.assert_called_once()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:209:8
208	
209	        assert len(results) == 3
210	        assert all(r["status"] == "scheduled" for r in results)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:210:8
209	        assert len(results) == 3
210	        assert all(r["status"] == "scheduled" for r in results)
211	        assert mock_task_queue.enqueue.call_count == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:211:8
210	        assert all(r["status"] == "scheduled" for r in results)
211	        assert mock_task_queue.enqueue.call_count == 3
212	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:267:8
266	
267	        assert result["original_file_id"] == "file-123"
268	        assert len(result["processing_tasks"]) == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:268:8
267	        assert result["original_file_id"] == "file-123"
268	        assert len(result["processing_tasks"]) == 3
269	        assert result["status"] == "processing_started"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:269:8
268	        assert len(result["processing_tasks"]) == 3
269	        assert result["status"] == "processing_started"
270	        assert mock_task_queue.enqueue.call_count == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:270:8
269	        assert result["status"] == "processing_started"
270	        assert mock_task_queue.enqueue.call_count == 3
271	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:314:8
313	
314	        assert "workflow_id" in result
315	        assert len(result["tasks"]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:315:8
314	        assert "workflow_id" in result
315	        assert len(result["tasks"]) == 2
316	        assert "estimated_completion" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:316:8
315	        assert len(result["tasks"]) == 2
316	        assert "estimated_completion" in result
317	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:398:8
397	
398	        assert len(result["scheduled_tasks"]) == 4
399	        assert result["status"] == "onboarding_started"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:399:8
398	        assert len(result["scheduled_tasks"]) == 4
399	        assert result["status"] == "onboarding_started"
400	        assert "workflow_id" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:400:8
399	        assert result["status"] == "onboarding_started"
400	        assert "workflow_id" in result
401	        assert mock_task_queue.enqueue.call_count == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:401:8
400	        assert "workflow_id" in result
401	        assert mock_task_queue.enqueue.call_count == 4
402	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:478:8
477	
478	        assert result["total_tasks"] == 6
479	        assert len(result["phases"]) == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:479:8
478	        assert result["total_tasks"] == 6
479	        assert len(result["phases"]) == 3
480	        assert "cycle_id" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:480:8
479	        assert len(result["phases"]) == 3
480	        assert "cycle_id" in result
481	        assert mock_task_queue.enqueue.call_count == 6

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:481:8
480	        assert "cycle_id" in result
481	        assert mock_task_queue.enqueue.call_count == 6
482	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:530:8
529	
530	        assert result["status"] == "retry_scheduled"
531	        assert result["policy_applied"]["max_retries"] == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:531:8
530	        assert result["status"] == "retry_scheduled"
531	        assert result["policy_applied"]["max_retries"] == 3
532	        mock_logger.error.assert_called_once()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:584:8
583	        )
584	        assert result["status"] == "success"
585	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:590:8
589	        )
590	        assert result["status"] == "error"
591	        assert "cleanup_task" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/integration/test_business_logic_integration.py:591:8
590	        assert result["status"] == "error"
591	        assert "cleanup_task" in result
592	        mock_task_queue.enqueue.assert_called_once()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:69:8
68	        # Verify performance characteristics
69	        assert len(results) == 4
70	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:72:8
71	        # Throughput should scale reasonably
72	        assert results[10]["throughput_per_sec"] > 100  # At least 100 invoices/sec
73	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:76:8
75	        avg_times = [r["avg_time_per_invoice"] for r in results.values()]
76	        assert max(avg_times) / min(avg_times) < 2.0  # Less than 2x variance
77	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:129:8
128	        # Verify concurrency improves performance
129	        assert len(sequential_results) == len(concurrent_results) == 20
130	        assert concurrent_time < sequential_time * 0.8  # At least 20% faster

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:130:8
129	        assert len(sequential_results) == len(concurrent_results) == 20
130	        assert concurrent_time < sequential_time * 0.8  # At least 20% faster
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:136:8
135	
136	        assert concurrent_throughput > sequential_throughput * 1.5  # 50% improvement
137	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:181:8
180	        # Verify performance
181	        assert len(results) == 1000
182	        assert calculations_per_second > 1000  # At least 1000 calculations/sec

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:182:8
181	        assert len(results) == 1000
182	        assert calculations_per_second > 1000  # At least 1000 calculations/sec
183	        assert execution_time < 1000  # Less than 1 second for 1000 invoices

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:183:8
182	        assert calculations_per_second > 1000  # At least 1000 calculations/sec
183	        assert execution_time < 1000  # Less than 1 second for 1000 invoices
184	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:244:8
243	        # Verify bulk operation is more efficient
244	        assert bulk_time < individual_time * 0.5  # At least 50% faster
245	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:250:8
249	
250	        assert bulk_throughput > individual_throughput * 2  # 2x improvement
251	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:310:8
309	        # Verify scaling characteristics
310	        assert results[1]["throughput_per_sec"] > 10  # Baseline throughput
311	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:311:8
310	        assert results[1]["throughput_per_sec"] > 10  # Baseline throughput
311	        assert (
312	            results[4]["throughput_per_sec"] > results[1]["throughput_per_sec"] * 2
313	        )  # 2x with 4 workers
314	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:314:8
313	        )  # 2x with 4 workers
314	        assert (
315	            results[8]["throughput_per_sec"] > results[4]["throughput_per_sec"] * 1.2
316	        )  # Some improvement with 8
317	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:371:8
370	        # Verify parallel execution is faster
371	        assert len(linear_results) == len(parallel_results) == 20
372	        assert parallel_time < linear_time * 0.8  # At least 20% faster (more realistic)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:372:8
371	        assert len(linear_results) == len(parallel_results) == 20
372	        assert parallel_time < linear_time * 0.8  # At least 20% faster (more realistic)
373	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:456:8
455	        # Verify caching improves performance
456	        assert len(no_cache_results) == len(cached_results) == 100
457	        assert cached_time < no_cache_time * 0.8  # At least 20% faster with cache

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:457:8
456	        assert len(no_cache_results) == len(cached_results) == 100
457	        assert cached_time < no_cache_time * 0.8  # At least 20% faster with cache
458	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:461:8
460	        cache_throughput = len(template_data) / (cached_time / 1000)
461	        assert cache_throughput > 100  # At least 100 renders per second
462	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:527:8
526	        # Verify concurrent processing is more efficient
527	        assert len(sequential_results) == len(concurrent_results) == 20
528	        assert concurrent_time < sequential_time * 0.7  # At least 30% faster

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:528:8
527	        assert len(sequential_results) == len(concurrent_results) == 20
528	        assert concurrent_time < sequential_time * 0.7  # At least 30% faster
529	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:532:8
531	        concurrent_throughput = len(files_data) / (concurrent_time / 1000)
532	        assert concurrent_throughput > 5  # At least 5 files per second
533	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:583:8
582	        # Verify operation completed and memory usage tracked
583	        assert result["result"] == 1000
584	        assert "memory_stats" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:584:8
583	        assert result["result"] == 1000
584	        assert "memory_stats" in result
585	        assert result["memory_stats"]["final_mb"] > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:585:8
584	        assert "memory_stats" in result
585	        assert result["memory_stats"]["final_mb"] > 0
586	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:599:27
598	                base_latency = 0.01  # 10ms base
599	                variance = random.uniform(0, 0.005)  # 0-5ms variance
600	                time.sleep(base_latency + variance)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:627:8
626	        # Verify latency characteristics
627	        assert len(latencies) == 50
628	        assert 8 < avg_latency < 20  # Average should be 8-20ms

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:628:8
627	        assert len(latencies) == 50
628	        assert 8 < avg_latency < 20  # Average should be 8-20ms
629	        assert p95 < max_latency  # P95 should be less than max

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:629:8
628	        assert 8 < avg_latency < 20  # Average should be 8-20ms
629	        assert p95 < max_latency  # P95 should be less than max
630	        assert p50 < p95 < p99  # Percentiles should be ordered

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:630:8
629	        assert p95 < max_latency  # P95 should be less than max
630	        assert p50 < p95 < p99  # Percentiles should be ordered
631	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:633:8
632	        # Performance requirements
633	        assert p95 < 25  # 95th percentile under 25ms
634	        assert p99 < 30  # 99th percentile under 30ms

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/performance/test_performance_benchmarks.py:634:8
633	        assert p95 < 25  # 95th percentile under 25ms
634	        assert p99 < 30  # 99th percentile under 30ms

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: src/dotmac_business_logic/tests/run_tests.py:12:0
11	import json
12	import subprocess
13	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b603_subprocess_without_shell_equals_true.html
   Location: src/dotmac_business_logic/tests/run_tests.py:55:21
54	
55	            result = subprocess.run(
56	                cmd, capture_output=True, text=True, cwd=Path(__file__).parent.parent
57	            )  # noqa: B008
58	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:23:8
22	
23	        assert customer.name == "Test Customer"
24	        assert customer.email == "test@example.com"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:24:8
23	        assert customer.name == "Test Customer"
24	        assert customer.email == "test@example.com"
25	        assert customer.is_active is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:25:8
24	        assert customer.email == "test@example.com"
25	        assert customer.is_active is True
26	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:43:8
42	        str_repr = f"{customer.name} ({customer.email})"
43	        assert "Test Customer" in str_repr
44	        assert "test@example.com" in str_repr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:44:8
43	        assert "Test Customer" in str_repr
44	        assert "test@example.com" in str_repr
45	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:57:8
56	
57	        assert invoice.invoice_number == "INV-001"
58	        assert invoice.status == "pending"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:58:8
57	        assert invoice.invoice_number == "INV-001"
58	        assert invoice.status == "pending"
59	        assert invoice.total_amount == Decimal("110.00")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:59:8
58	        assert invoice.status == "pending"
59	        assert invoice.total_amount == Decimal("110.00")
60	        assert invoice.currency == "USD"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:60:8
59	        assert invoice.total_amount == Decimal("110.00")
60	        assert invoice.currency == "USD"
61	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:68:8
67	
68	        assert total == Decimal("110.00")
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:83:8
82	        # Test that draft can transition to pending
83	        assert "pending" in valid_transitions["draft"]
84	        # Test that paid cannot transition to pending

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:85:8
84	        # Test that paid cannot transition to pending
85	        assert "pending" not in valid_transitions["paid"]
86	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:93:8
92	        # Due date should not be before issue date
93	        assert due_date >= issue_date
94	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:102:8
101	        is_overdue = past_due_date < current_date
102	        assert is_overdue is True
103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:115:8
114	
115	        assert payment.payment_number == "PAY-001"
116	        assert payment.amount == Decimal("110.00")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:116:8
115	        assert payment.payment_number == "PAY-001"
116	        assert payment.amount == Decimal("110.00")
117	        assert payment.status == "completed"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:117:8
116	        assert payment.amount == Decimal("110.00")
117	        assert payment.status == "completed"
118	        assert payment.payment_method == "credit_card"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:118:8
117	        assert payment.status == "completed"
118	        assert payment.payment_method == "credit_card"
119	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:126:8
125	
126	        assert valid_amount > 0
127	        assert invalid_amount < 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:127:8
126	        assert valid_amount > 0
127	        assert invalid_amount < 0
128	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:134:8
133	
134	        assert test_status in valid_statuses
135	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:147:8
146	
147	        assert test_method in valid_methods
148	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:162:8
161	        # Verify the relationship
162	        assert invoice_data["customer_id"] == customer_id
163	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:173:8
172	        # Verify the relationship
173	        assert payment_data["invoice_id"] == invoice_id
174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:181:8
180	
181	        assert remaining_balance == Decimal("60.00")
182	        assert remaining_balance > 0  # Still has outstanding balance

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:182:8
181	        assert remaining_balance == Decimal("60.00")
182	        assert remaining_balance > 0  # Still has outstanding balance
183	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:193:8
192	
193	        assert test_currency in valid_currencies
194	        assert len(test_currency) == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:194:8
193	        assert test_currency in valid_currencies
194	        assert len(test_currency) == 3
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:202:8
201	        # Different tenants should have different IDs
202	        assert tenant_a != tenant_b
203	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:209:8
208	
209	        assert rounded_amount == Decimal("123.46")
210	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:221:12
220	        for field in required_fields:
221	            assert field in sample_data
222	            assert sample_data[field] is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:222:12
221	            assert field in sample_data
222	            assert sample_data[field] is not None
223	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:234:8
233	
234	        assert line_total == Decimal("100.00")
235	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:242:8
241	
242	        assert tax_amount == Decimal("10.00")
243	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:251:8
250	
251	        assert discount_amount == Decimal("15.00")
252	        assert final_amount == Decimal("85.00")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_billing_models.py:252:8
251	        assert discount_amount == Decimal("15.00")
252	        assert final_amount == Decimal("85.00")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:25:8
24	        engine = MockTemplateEngine()
25	        assert engine.templates == {}
26	        assert engine.default_vars == {}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:26:8
25	        assert engine.templates == {}
26	        assert engine.default_vars == {}
27	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:44:8
43	
44	        assert result == sample_template_data["expected_output"]
45	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:60:8
59	        result = engine.render_conditional("template", {"show_greeting": True})
60	        assert result == "Hello World!"
61	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:64:8
63	        result = engine.render_conditional("template", {"show_greeting": False})
64	        assert result == "No greeting"
65	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:78:8
77	
78	        assert len(result) == 3
79	        assert "Item: apple" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:79:8
78	        assert len(result) == 3
79	        assert "Item: apple" in result
80	        assert "Item: cherry" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:80:8
79	        assert "Item: apple" in result
80	        assert "Item: cherry" in result
81	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:98:8
97	        result = engine.render_with_error("good template", {})
98	        assert result == "success"
99	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:118:8
117	        cache = MockCacheIntegration(mock_redis)
118	        assert cache.redis is not None
119	        assert cache.hit_count == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:119:8
118	        assert cache.redis is not None
119	        assert cache.hit_count == 0
120	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:141:8
140	        result = await cache.set("test_key", "test_value")
141	        assert result is True
142	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:145:8
144	        value = await cache.get("test_key")
145	        assert value == "test_value"
146	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:149:8
148	        value = await cache.get("non_existent")
149	        assert value is None
150	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:174:8
173	        cached = await cache.get_cached_template("test_template")
174	        assert cached == sample_template_data
175	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:203:8
202	
203	        assert cache.metrics["hits"] == 2
204	        assert cache.metrics["misses"] == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:204:8
203	        assert cache.metrics["hits"] == 2
204	        assert cache.metrics["misses"] == 1
205	        assert cache.get_hit_ratio() == 2 / 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:205:8
204	        assert cache.metrics["misses"] == 1
205	        assert cache.get_hit_ratio() == 2 / 3
206	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:219:8
218	        generator = MockDocumentGenerator()
219	        assert "pdf" in generator.supported_formats
220	        assert len(generator.supported_formats) == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:220:8
219	        assert "pdf" in generator.supported_formats
220	        assert len(generator.supported_formats) == 4
221	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:236:8
235	
236	        assert pdf_bytes == b"PDF content"
237	        assert isinstance(pdf_bytes, bytes)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:237:8
236	        assert pdf_bytes == b"PDF content"
237	        assert isinstance(pdf_bytes, bytes)
238	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:267:8
266	
267	        assert "Hello Test!" in document
268	        assert "<html>" in document

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:268:8
267	        assert "Hello Test!" in document
268	        assert "<html>" in document
269	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:289:8
288	
289	        assert len(results) == 3
290	        assert all(r["status"] == "completed" for r in results)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:290:8
289	        assert len(results) == 3
290	        assert all(r["status"] == "completed" for r in results)
291	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:305:8
304	        processor = MockFileProcessor()
305	        assert ".pdf" in processor.supported_types
306	        assert processor.max_file_size == 10485760

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:306:8
305	        assert ".pdf" in processor.supported_types
306	        assert processor.max_file_size == 10485760
307	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:330:8
329	        valid, message = processor.validate_file("document.pdf", 1024)
330	        assert valid is True
331	        assert message == "Valid file"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:331:8
330	        assert valid is True
331	        assert message == "Valid file"
332	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:335:8
334	        valid, message = processor.validate_file("image.jpg", 1024)
335	        assert valid is False
336	        assert "Unsupported" in message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:336:8
335	        assert valid is False
336	        assert "Unsupported" in message
337	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:340:8
339	        valid, message = processor.validate_file("document.pdf", 10485760)
340	        assert valid is False
341	        assert "too large" in message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:341:8
340	        assert valid is False
341	        assert "too large" in message
342	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:362:8
361	        result = await processor.process_upload("test.txt", b"test content")
362	        assert result["status"] == "success"
363	        assert result["file_id"] == "file-123"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:363:8
362	        assert result["status"] == "success"
363	        assert result["file_id"] == "file-123"
364	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:367:8
366	        result = await processor.process_upload("empty.txt", b"")
367	        assert result["status"] == "error"
368	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:387:8
386	
387	        assert metadata["filename"] == "document.txt"
388	        assert metadata["extension"] == ".txt"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:388:8
387	        assert metadata["filename"] == "document.txt"
388	        assert metadata["extension"] == ".txt"
389	        assert metadata["size"] == 1024

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:389:8
388	        assert metadata["extension"] == ".txt"
389	        assert metadata["size"] == 1024
390	        assert "mime_type" in metadata

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:390:8
389	        assert metadata["size"] == 1024
390	        assert "mime_type" in metadata
391	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:436:8
435	
436	        assert result1 == result2 == "Hello Test!"
437	        assert "template:test" in system.cache

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:437:8
436	        assert result1 == result2 == "Hello Test!"
437	        assert "template:test" in system.cache
438	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:459:8
458	        result = system.generate_with_fallback("good content", "pdf", "html")
459	        assert result == "PDF document"
460	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_files_processing.py:463:8
462	        result = system.generate_with_fallback("error content", "pdf", "html")
463	        assert result == "HTML document"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:26:8
25	        engine = MockTaskEngine(mock_redis, test_config["tasks"])
26	        assert engine.redis is not None
27	        assert engine.config == test_config["tasks"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:27:8
26	        assert engine.redis is not None
27	        assert engine.config == test_config["tasks"]
28	        assert engine.is_running is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:28:8
27	        assert engine.config == test_config["tasks"]
28	        assert engine.is_running is False
29	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:37:8
36	
37	        assert task_id == "task-123"
38	        mock_task_queue.enqueue.assert_called_once()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:46:8
45	
46	        assert status == "pending"
47	        mock_task_queue.get_status.assert_called_once_with(task_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:55:8
54	
55	        assert result is True
56	        mock_task_queue.cancel.assert_called_once_with(task_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:71:8
70	        queue = MockTaskQueue(mock_redis, "test_queue")
71	        assert queue.redis is not None
72	        assert queue.queue_name == "test_queue"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:72:8
71	        assert queue.redis is not None
72	        assert queue.queue_name == "test_queue"
73	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:81:8
80	        )
81	        assert task_id is not None
82	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:101:8
100	
101	        assert sorted_tasks[0]["priority"] == "high"
102	        assert sorted_tasks[-1]["priority"] == "low"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:102:8
101	        assert sorted_tasks[0]["priority"] == "high"
102	        assert sorted_tasks[-1]["priority"] == "low"
103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:124:8
123	
124	        assert workflow.name == "test_workflow"
125	        assert len(workflow.steps) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:125:8
124	        assert workflow.name == "test_workflow"
125	        assert len(workflow.steps) == 2
126	        assert workflow.steps[0]["name"] == "validate"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:126:8
125	        assert len(workflow.steps) == 2
126	        assert workflow.steps[0]["name"] == "validate"
127	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:144:8
143	        result = await executor.execute_step("validate", {"test": "data"})
144	        assert result["valid"] is True
145	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:148:8
147	        result = await executor.execute_step("process", {"test": "data"})
148	        assert result["processed"] is True
149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:161:12
160	            failing_step({})
161	            assert False, "Should have raised exception"
162	        except WorkflowError as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:163:12
162	        except WorkflowError as e:
163	            assert str(e) == "Step failed"
164	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:180:8
179	        worker = MockWorker(mock_redis, test_config["tasks"])
180	        assert worker.redis is not None
181	        assert worker.is_running is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:181:8
180	        assert worker.redis is not None
181	        assert worker.is_running is False
182	        assert worker.processed_count == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:182:8
181	        assert worker.is_running is False
182	        assert worker.processed_count == 0
183	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:200:8
199	
200	        assert result["status"] == "completed"
201	        assert worker.processed_count == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:201:8
200	        assert result["status"] == "completed"
201	        assert worker.processed_count == 1
202	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:224:8
223	            worker.process_with_retry({})
224	        except Exception:
225	            pass
226	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:229:8
228	        result = worker.process_with_retry({})
229	        assert result == "success"
230	        assert worker.retry_count == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:230:8
229	        assert result == "success"
230	        assert worker.retry_count == 2
231	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:245:8
244	        scheduler = MockScheduler()
245	        assert len(scheduler.jobs) == 0
246	        assert scheduler.is_running is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:246:8
245	        assert len(scheduler.jobs) == 0
246	        assert scheduler.is_running is False
247	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:265:8
264	
265	        assert "daily_report" in scheduler.jobs
266	        assert scheduler.jobs["daily_report"]["cron"] == "0 9 * * *"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:266:8
265	        assert "daily_report" in scheduler.jobs
266	        assert scheduler.jobs["daily_report"]["cron"] == "0 9 * * *"
267	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:279:8
278	
279	        assert validate_cron(valid_cron) is True
280	        assert validate_cron(invalid_cron) is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:280:8
279	        assert validate_cron(valid_cron) is True
280	        assert validate_cron(invalid_cron) is False
281	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:288:8
287	        # Job should run in the future
288	        assert next_hour > now
289	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:307:8
306	        monitor = MockTaskMonitor(mock_redis)
307	        assert monitor.redis is not None
308	        assert monitor.metrics["tasks_completed"] == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:308:8
307	        assert monitor.redis is not None
308	        assert monitor.metrics["tasks_completed"] == 0
309	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:334:8
333	
334	        assert "task-123" in metrics.data
335	        assert metrics.data["task-123"]["status"] == "completed"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:335:8
334	        assert "task-123" in metrics.data
335	        assert metrics.data["task-123"]["status"] == "completed"
336	        assert metrics.data["task-123"]["execution_time"] > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:336:8
335	        assert metrics.data["task-123"]["status"] == "completed"
336	        assert metrics.data["task-123"]["execution_time"] > 0
337	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:355:8
354	
355	        assert redis_status["status"] == "healthy"
356	        assert queue_status["status"] == "healthy"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:356:8
355	        assert redis_status["status"] == "healthy"
356	        assert queue_status["status"] == "healthy"
357	        assert queue_status["pending_tasks"] == 5

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:357:8
356	        assert queue_status["status"] == "healthy"
357	        assert queue_status["pending_tasks"] == 5
358	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:375:8
374	
375	        assert hasattr(example_task, "_is_task")
376	        assert example_task._is_task is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:376:8
375	        assert hasattr(example_task, "_is_task")
376	        assert example_task._is_task is True
377	        assert example_task._task_options["max_retries"] == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:377:8
376	        assert example_task._is_task is True
377	        assert example_task._task_options["max_retries"] == 3
378	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:394:8
393	
394	        assert hasattr(cleanup_task, "_is_periodic")
395	        assert cleanup_task._is_periodic is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:395:8
394	        assert hasattr(cleanup_task, "_is_periodic")
395	        assert cleanup_task._is_periodic is True
396	        assert cleanup_task._cron_schedule == "0 */6 * * *"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_business_logic/tests/unit/test_tasks_engine.py:396:8
395	        assert cleanup_task._is_periodic is True
396	        assert cleanup_task._cron_schedule == "0 */6 * * *"

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_isp/api/file_router.py:414:24
413	    # Check upload directory access
414	    upload_dir = Path(f"/tmp/uploads/{deps.tenant_id}")
415	    upload_dir.mkdir(parents=True, exist_ok=True)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'invalid'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_isp/core/auth.py:70:20
69	        # Simulate token validation (replace with actual JWT validation)
70	        if token == "invalid":
71	            raise HTTPException(

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: src/dotmac_isp/core/cache_system.py:163:15
162	        auth_data = f"{auth_header[-8:]}:{user_role}"  # Last 8 chars of token
163	        return hashlib.md5(auth_data.encode()).hexdigest()[:8]
164	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_isp/core/config/handlers/validation_handler.py:188:23
187	            host = api_config["host"]
188	            if host == "0.0.0.0":
189	                context.add_warning(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_change'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_isp/core/security/audit.py:22:22
21	    RATE_LIMIT_EXCEEDED = "rate_limit_exceeded"
22	    PASSWORD_CHANGE = "password_change"  # noqa: S105 - label string, not a secret
23	    ACCOUNT_LOCKED = "account_locked"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_isp/models.py:31:4
30	        importlib.import_module(module_map[module_name])
31	    except Exception:
32	        # Module may be optional/not yet implemented; ignore import errors
33	        pass
34	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_isp/modules/billing/csv_exporter.py:11:11
10	def export_invoices_csv(*args: Any, **kwargs: Any) -> str:  # noqa: ANN001
11	    return "/tmp/invoices.csv"
12	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_isp/modules/billing/csv_exporter.py:15:11
14	def export_payments_csv(*args: Any, **kwargs: Any) -> str:  # noqa: ANN001
15	    return "/tmp/payments.csv"
16	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:46:8
45	
46	        assert area.name == "Test Service Area"
47	        assert area.tenant_id == tenant_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:47:8
46	        assert area.name == "Test Service Area"
47	        assert area.tenant_id == tenant_id
48	        assert len(area.polygon_coordinates) == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:48:8
47	        assert area.tenant_id == tenant_id
48	        assert len(area.polygon_coordinates) == 4
49	        assert area.coverage_percentage == 85.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:49:8
48	        assert len(area.polygon_coordinates) == 4
49	        assert area.coverage_percentage == 85.0
50	        assert "fiber" in area.service_types

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:50:8
49	        assert area.coverage_percentage == 85.0
50	        assert "fiber" in area.service_types
51	        assert "wireless" in area.service_types

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:51:8
50	        assert "fiber" in area.service_types
51	        assert "wireless" in area.service_types
52	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:68:8
67	
68	        assert 0 <= area.coverage_percentage <= 100
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:96:8
95	
96	        assert node.name == "Test Router"
97	        assert node.node_type == NetworkNodeTypeEnum.CORE_ROUTER

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:97:8
96	        assert node.name == "Test Router"
97	        assert node.node_type == NetworkNodeTypeEnum.CORE_ROUTER
98	        assert node.latitude == 45.5152

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:98:8
97	        assert node.node_type == NetworkNodeTypeEnum.CORE_ROUTER
98	        assert node.latitude == 45.5152
99	        assert node.longitude == -122.6784

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:99:8
98	        assert node.latitude == 45.5152
99	        assert node.longitude == -122.6784
100	        assert node.bandwidth_mbps == 10000

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:100:8
99	        assert node.longitude == -122.6784
100	        assert node.bandwidth_mbps == 10000
101	        assert node.coverage_radius_km == 5.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:101:8
100	        assert node.bandwidth_mbps == 10000
101	        assert node.coverage_radius_km == 5.0
102	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:105:8
104	        """Test NetworkNodeTypeEnum values."""
105	        assert NetworkNodeTypeEnum.CORE_ROUTER == "core_router"
106	        assert NetworkNodeTypeEnum.WIFI_AP == "wifi_ap"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:106:8
105	        assert NetworkNodeTypeEnum.CORE_ROUTER == "core_router"
106	        assert NetworkNodeTypeEnum.WIFI_AP == "wifi_ap"
107	        assert NetworkNodeTypeEnum.CELL_TOWER == "cell_tower"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:107:8
106	        assert NetworkNodeTypeEnum.WIFI_AP == "wifi_ap"
107	        assert NetworkNodeTypeEnum.CELL_TOWER == "cell_tower"
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:121:8
120	
121	        assert node.node_type == NetworkNodeTypeEnum.WIFI_AP
122	        assert node.coverage_radius_km == 0.5

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:122:8
121	        assert node.node_type == NetworkNodeTypeEnum.WIFI_AP
122	        assert node.coverage_radius_km == 0.5
123	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:157:8
156	
157	        assert gap.gap_type == "no_coverage"
158	        assert gap.severity == "high"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:158:8
157	        assert gap.gap_type == "no_coverage"
158	        assert gap.severity == "high"
159	        assert gap.affected_customers == 150

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:159:8
158	        assert gap.severity == "high"
159	        assert gap.affected_customers == 150
160	        assert gap.potential_revenue == 135000.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:160:8
159	        assert gap.affected_customers == 150
160	        assert gap.potential_revenue == 135000.0
161	        assert len(gap.recommendations) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:161:8
160	        assert gap.potential_revenue == 135000.0
161	        assert len(gap.recommendations) == 2
162	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:193:8
192	
193	        assert territory.name == "Northwest Territory"
194	        assert territory.territory_type == "sales"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:194:8
193	        assert territory.name == "Northwest Territory"
194	        assert territory.territory_type == "sales"
195	        assert territory.color == "#FF5733"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:195:8
194	        assert territory.territory_type == "sales"
195	        assert territory.color == "#FF5733"
196	        assert territory.customer_count == 1250

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:196:8
195	        assert territory.color == "#FF5733"
196	        assert territory.customer_count == 1250
197	        assert territory.revenue_target == 750000.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:197:8
196	        assert territory.customer_count == 1250
197	        assert territory.revenue_target == 750000.0
198	        assert territory.actual_revenue == 680000.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:198:8
197	        assert territory.revenue_target == 750000.0
198	        assert territory.actual_revenue == 680000.0
199	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:212:8
211	        performance = (territory.actual_revenue / territory.revenue_target) * 100
212	        assert performance == 85.0
213	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:247:8
246	
247	        assert route.optimization_type == "shortest"
248	        assert route.vehicle_type == "truck"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:248:8
247	        assert route.optimization_type == "shortest"
248	        assert route.vehicle_type == "truck"
249	        assert route.total_distance_km == 12.5

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:249:8
248	        assert route.vehicle_type == "truck"
249	        assert route.total_distance_km == 12.5
250	        assert route.estimated_duration_minutes == 180

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:250:8
249	        assert route.total_distance_km == 12.5
250	        assert route.estimated_duration_minutes == 180
251	        assert len(route.waypoints) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:251:8
250	        assert route.estimated_duration_minutes == 180
251	        assert len(route.waypoints) == 2
252	        assert len(route.optimized_route) == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:252:8
251	        assert len(route.waypoints) == 2
252	        assert len(route.optimized_route) == 4
253	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:260:8
259	        """Test ServiceTypeEnum values."""
260	        assert ServiceTypeEnum.FIBER == "fiber"
261	        assert ServiceTypeEnum.WIRELESS == "wireless"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:261:8
260	        assert ServiceTypeEnum.FIBER == "fiber"
261	        assert ServiceTypeEnum.WIRELESS == "wireless"
262	        assert ServiceTypeEnum.CABLE == "cable"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:262:8
261	        assert ServiceTypeEnum.WIRELESS == "wireless"
262	        assert ServiceTypeEnum.CABLE == "cable"
263	        assert ServiceTypeEnum.DSL == "dsl"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:263:8
262	        assert ServiceTypeEnum.CABLE == "cable"
263	        assert ServiceTypeEnum.DSL == "dsl"
264	        assert ServiceTypeEnum.FIXED_WIRELESS == "fixed_wireless"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:264:8
263	        assert ServiceTypeEnum.DSL == "dsl"
264	        assert ServiceTypeEnum.FIXED_WIRELESS == "fixed_wireless"
265	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:268:8
267	        """Test NetworkNodeTypeEnum values."""
268	        assert NetworkNodeTypeEnum.CORE_ROUTER == "core_router"
269	        assert NetworkNodeTypeEnum.DISTRIBUTION_ROUTER == "distribution_router"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:269:8
268	        assert NetworkNodeTypeEnum.CORE_ROUTER == "core_router"
269	        assert NetworkNodeTypeEnum.DISTRIBUTION_ROUTER == "distribution_router"
270	        assert NetworkNodeTypeEnum.ACCESS_SWITCH == "access_switch"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:270:8
269	        assert NetworkNodeTypeEnum.DISTRIBUTION_ROUTER == "distribution_router"
270	        assert NetworkNodeTypeEnum.ACCESS_SWITCH == "access_switch"
271	        assert NetworkNodeTypeEnum.WIFI_AP == "wifi_ap"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:271:8
270	        assert NetworkNodeTypeEnum.ACCESS_SWITCH == "access_switch"
271	        assert NetworkNodeTypeEnum.WIFI_AP == "wifi_ap"
272	        assert NetworkNodeTypeEnum.CELL_TOWER == "cell_tower"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:272:8
271	        assert NetworkNodeTypeEnum.WIFI_AP == "wifi_ap"
272	        assert NetworkNodeTypeEnum.CELL_TOWER == "cell_tower"
273	        assert NetworkNodeTypeEnum.FIBER_SPLICE == "fiber_splice"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:273:8
272	        assert NetworkNodeTypeEnum.CELL_TOWER == "cell_tower"
273	        assert NetworkNodeTypeEnum.FIBER_SPLICE == "fiber_splice"
274	        assert NetworkNodeTypeEnum.POP == "pop"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:274:8
273	        assert NetworkNodeTypeEnum.FIBER_SPLICE == "fiber_splice"
274	        assert NetworkNodeTypeEnum.POP == "pop"
275	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:278:8
277	        """Test CoverageStatusEnum values."""
278	        assert CoverageStatusEnum.EXCELLENT == "excellent"
279	        assert CoverageStatusEnum.GOOD == "good"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:279:8
278	        assert CoverageStatusEnum.EXCELLENT == "excellent"
279	        assert CoverageStatusEnum.GOOD == "good"
280	        assert CoverageStatusEnum.POOR == "poor"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:280:8
279	        assert CoverageStatusEnum.GOOD == "good"
280	        assert CoverageStatusEnum.POOR == "poor"
281	        assert CoverageStatusEnum.NO_COVERAGE == "no_coverage"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_models.py:281:8
280	        assert CoverageStatusEnum.POOR == "poor"
281	        assert CoverageStatusEnum.NO_COVERAGE == "no_coverage"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:73:16
72	
73	                assert response.status_code == 201
74	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:75:16
74	                data = response.json()
75	                assert data["name"] == "Test Service Area"
76	                assert data["coverage_percentage"] == 85.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:76:16
75	                assert data["name"] == "Test Service Area"
76	                assert data["coverage_percentage"] == 85.0
77	                assert len(data["service_types"]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:77:16
76	                assert data["coverage_percentage"] == 85.0
77	                assert len(data["service_types"]) == 2
78	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:108:16
107	
108	                assert response.status_code == 200
109	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:110:16
109	                data = response.json()
110	                assert len(data) == 2
111	                assert data[0]["name"] == "Area 1"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:111:16
110	                assert len(data) == 2
111	                assert data[0]["name"] == "Area 1"
112	                assert data[1]["name"] == "Area 2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:112:16
111	                assert data[0]["name"] == "Area 1"
112	                assert data[1]["name"] == "Area 2"
113	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:135:16
134	
135	                assert response.status_code == 200
136	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:137:16
136	                data = response.json()
137	                assert data["id"] == str(area_id)
138	                assert data["name"] == "Test Service Area"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:138:16
137	                assert data["id"] == str(area_id)
138	                assert data["name"] == "Test Service Area"
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:164:16
163	
164	                assert response.status_code == 200
165	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:166:16
165	                data = response.json()
166	                assert data["coverage_percentage"] == 85.5
167	                assert data["total_nodes"] == 12

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:167:16
166	                assert data["coverage_percentage"] == 85.5
167	                assert data["total_nodes"] == 12
168	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:200:16
199	
200	                assert response.status_code == 201
201	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:202:16
201	                data = response.json()
202	                assert data["name"] == "Test Router"
203	                assert data["node_type"] == "core_router"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:203:16
202	                assert data["name"] == "Test Router"
203	                assert data["node_type"] == "core_router"
204	                assert data["bandwidth_mbps"] == 10000

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:204:16
203	                assert data["node_type"] == "core_router"
204	                assert data["bandwidth_mbps"] == 10000
205	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:240:16
239	
240	                assert response.status_code == 200
241	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:242:16
241	                data = response.json()
242	                assert len(data) == 2
243	                assert data[0]["name"] == "Router 1"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:243:16
242	                assert len(data) == 2
243	                assert data[0]["name"] == "Router 1"
244	                assert data[1]["name"] == "WiFi AP 1"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:244:16
243	                assert data[0]["name"] == "Router 1"
244	                assert data[1]["name"] == "WiFi AP 1"
245	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:282:16
281	
282	                assert response.status_code == 201
283	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:284:16
283	                data = response.json()
284	                assert data["name"] == "Northwest Territory"
285	                assert data["territory_type"] == "sales"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:285:16
284	                assert data["name"] == "Northwest Territory"
285	                assert data["territory_type"] == "sales"
286	                assert data["revenue_target"] == 500000.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:286:16
285	                assert data["territory_type"] == "sales"
286	                assert data["revenue_target"] == 500000.0
287	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:312:16
311	
312	                assert response.status_code == 200
313	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:314:16
313	                data = response.json()
314	                assert data["revenue_achievement"] == 85.0
315	                assert data["performance_grade"] == "B+"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:315:16
314	                assert data["revenue_achievement"] == 85.0
315	                assert data["performance_grade"] == "B+"
316	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:358:16
357	
358	                assert response.status_code == 200
359	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:360:16
359	                data = response.json()
360	                assert data["total_distance_km"] == 8.5
361	                assert data["estimated_duration_minutes"] == 120

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:361:16
360	                assert data["total_distance_km"] == 8.5
361	                assert data["estimated_duration_minutes"] == 120
362	                assert len(data["optimized_route"]) == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:362:16
361	                assert data["estimated_duration_minutes"] == 120
362	                assert len(data["optimized_route"]) == 3
363	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:398:16
397	
398	                assert response.status_code == 200
399	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:400:16
399	                data = response.json()
400	                assert data["total_routes"] == 1
401	                assert data["total_distance_km"] == 15.2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:401:16
400	                assert data["total_routes"] == 1
401	                assert data["total_distance_km"] == 15.2
402	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:425:16
424	
425	                assert (
426	                    response.status_code == 500
427	                )  # Will be handled by standard_exception_handler
428	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:450:12
449	            # Validation would be handled by Pydantic schemas
450	            assert response.status_code in [400, 422]
451	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:457:8
456	        # Would be handled by authentication middleware
457	        assert response.status_code == 401
458	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:486:16
485	
486	                assert response.status_code == 200
487	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:488:16
487	                data = response.json()
488	                assert data["total_service_areas"] == 25
489	                assert data["average_coverage"] == 82.5

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:489:16
488	                assert data["total_service_areas"] == 25
489	                assert data["average_coverage"] == 82.5
490	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:517:16
516	
517	                assert response.status_code == 200
518	                data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:519:16
518	                data = response.json()
519	                assert data["total_territories"] == 12
520	                assert len(data["top_performers"]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_router.py:520:16
519	                assert data["total_territories"] == 12
520	                assert len(data["top_performers"]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:97:20
96	
97	                    assert result is not None
98	                    assert result["coverage_percentage"] == 85.5

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:98:20
97	                    assert result is not None
98	                    assert result["coverage_percentage"] == 85.5
99	                    assert result["total_nodes"] == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:99:20
98	                    assert result["coverage_percentage"] == 85.5
99	                    assert result["total_nodes"] == 2
100	                    assert "analysis_timestamp" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:100:20
99	                    assert result["total_nodes"] == 2
100	                    assert "analysis_timestamp" in result
101	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:140:16
139	
140	                assert len(gaps) == 1
141	                assert gaps[0]["gap_type"] == "no_coverage"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:141:16
140	                assert len(gaps) == 1
141	                assert gaps[0]["gap_type"] == "no_coverage"
142	                assert gaps[0]["affected_customers"] == 200

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:142:16
141	                assert gaps[0]["gap_type"] == "no_coverage"
142	                assert gaps[0]["affected_customers"] == 200
143	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:170:12
169	
170	            assert len(recommendations) > 0
171	            assert recommendations[0]["priority"] in ["high", "medium", "low"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:171:12
170	            assert len(recommendations) > 0
171	            assert recommendations[0]["priority"] in ["high", "medium", "low"]
172	            assert "estimated_cost" in recommendations[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:172:12
171	            assert recommendations[0]["priority"] in ["high", "medium", "low"]
172	            assert "estimated_cost" in recommendations[0]
173	            assert "estimated_revenue" in recommendations[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:173:12
172	            assert "estimated_cost" in recommendations[0]
173	            assert "estimated_revenue" in recommendations[0]
174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:216:12
215	
216	            assert result.name == "Northwest Territory"
217	            assert result.territory_type == "sales"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:217:12
216	            assert result.name == "Northwest Territory"
217	            assert result.territory_type == "sales"
218	            assert result.revenue_target == 500000.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:218:12
217	            assert result.territory_type == "sales"
218	            assert result.revenue_target == 500000.0
219	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:241:12
240	
241	            assert performance["revenue_achievement"] == 85.0  # 85k/100k * 100
242	            assert performance["customer_count"] == 120

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:242:12
241	            assert performance["revenue_achievement"] == 85.0  # 85k/100k * 100
242	            assert performance["customer_count"] == 120
243	            assert "performance_grade" in performance

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:243:12
242	            assert performance["customer_count"] == 120
243	            assert "performance_grade" in performance
244	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:284:16
283	
284	                assert result["optimized_territories"] == 2
285	                assert result["performance_improvement"] > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:285:16
284	                assert result["optimized_territories"] == 2
285	                assert result["performance_improvement"] > 0
286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:330:12
329	
330	            assert result["total_distance_km"] == 8.5
331	            assert result["estimated_duration_minutes"] == 120

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:331:12
330	            assert result["total_distance_km"] == 8.5
331	            assert result["estimated_duration_minutes"] == 120
332	            assert len(result["optimized_route"]) == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:332:12
331	            assert result["estimated_duration_minutes"] == 120
332	            assert len(result["optimized_route"]) == 3
333	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:360:12
359	
360	            assert result["total_routes"] == 1
361	            assert result["optimized_sequence"] == [0, 2, 1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:361:12
360	            assert result["total_routes"] == 1
361	            assert result["optimized_sequence"] == [0, 2, 1]
362	            assert result["total_distance_km"] > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:362:12
361	            assert result["optimized_sequence"] == [0, 2, 1]
362	            assert result["total_distance_km"] > 0
363	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:405:16
404	
405	                assert len(coverage_data["low_coverage_areas"]) == 2
406	                assert optimization_result["performance_improvement"] > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_isp/modules/gis/tests/test_services.py:406:16
405	                assert len(coverage_data["low_coverage_areas"]) == 2
406	                assert optimization_result["performance_improvement"] > 0

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_isp/modules/resellers/customer_management_advanced.py:738:25
737	
738	        selected_range = random.choices(ranges, weights=weights)[0]
739	        return round(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_isp/modules/resellers/customer_management_advanced.py:740:12
739	        return round(
740	            random.uniform(selected_range[0], selected_range[1]), 1
741	        )  # noqa: S311 - demo-only

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_isp/modules/resellers/customer_management_advanced.py:759:15
758	        interactions = ["email", "phone_call", "meeting", "support_ticket", "training"]
759	        return random.choice(interactions)  # noqa: S311 - demo-only
760	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_isp/modules/resellers/customer_management_advanced.py:765:15
764	
765	        return random.randint(1, 45)  # noqa: S311 - demo-only
766	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_isp/modules/resellers/customer_management_advanced.py:773:15
772	        weights = [5, 5, 10, 8, 8, 40, 10, 5, 5, 4]  # Active customers weighted higher
773	        return random.choices(stages, weights=weights)[0]  # noqa: S311 - demo-only
774	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_isp/modules/resellers/customer_management_advanced.py:792:22
791	
792	        num_factors = random.randint(0, 3)
793	        return random.sample(all_factors, num_factors)  # noqa: S311 - demo-only

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_isp/modules/resellers/customer_management_advanced.py:793:15
792	        num_factors = random.randint(0, 3)
793	        return random.sample(all_factors, num_factors)  # noqa: S311 - demo-only
794	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pwd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_isp/sdks/contracts/auth.py:14:15
13	
14	    PASSWORD = "pwd"  # noqa: S105 - enum label, not a secret
15	    JWT = "jwt"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_reset_required'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_isp/shared/enums.py:151:30
150	    LOCKED = "locked"
151	    PASSWORD_RESET_REQUIRED = "password_reset_required"  # noqa: S105 - status label
152	    DELETED = "deleted"

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_management/api/v1/public_signup.py:281:29
280	                "signup_timestamp": datetime.now(timezone.utc).isoformat(),
281	                "signup_ip": "0.0.0.0",  # Would get from request
282	                "verification_code": verification_code,
283	                "verification_expires": (
284	                    datetime.now(timezone.utc) + timedelta(hours=24)
285	                ).isoformat(),
286	                "public_signup": True,
287	            },
288	            status=TenantStatus.PENDING_VERIFICATION,
289	            created_at=datetime.now(timezone.utc),
290	        )
291	
292	        # Save tenant to database
293	        db.add(tenant)
294	        db.commit()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/database.py:69:4
68	    _init_engine()
69	    assert _engine is not None
70	    return _engine

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/database.py:81:4
80	    _init_engine()
81	    assert _session_maker is not None
82	    async with _session_maker() as session:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/database.py:102:4
101	    _init_engine()
102	    assert _session_maker is not None
103	    return _session_maker()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/infrastructure/dns/dns_validation_adapter.py:203:16
202	                    days_until_expiry = (expires_datetime - datetime.utcnow()).days
203	                except Exception:
204	                    pass
205	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/infrastructure/dns/dns_validation_adapter.py:333:16
332	                    result["exists"] = True
333	                except Exception:
334	                    pass
335	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/infrastructure/dns/dns_validation_adapter.py:342:16
341	                    result["exists"] = True
342	                except Exception:
343	                    pass
344	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_management/main.py:510:33
509	
510	        host = os.getenv("HOST", "0.0.0.0")
511	        port = int(os.getenv("PORT", "8001"))

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_management/main_simple.py:125:29
124	if __name__ == "__main__":
125	    host = os.getenv("HOST", "0.0.0.0")
126	    port = int(os.getenv("PORT", "8001"))

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: src/dotmac_management/services/file_service.py:90:27
89	                # Calculate hashes
90	                md5_hash = hashlib.md5(file_content).hexdigest()
91	                sha256_hash = hashlib.sha256(file_content).hexdigest()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$%^&*'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_management/services/tenant_admin_provisioning.py:265:25
264	        # Generate cryptographically secure password
265	        password_chars = "ABCDEFGHJKMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$%^&*"  # noqa: S105 - character set
266	        password = "".join(secrets.choice(password_chars) for _ in range(16))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: src/dotmac_management/tests/e2e/cleanup.py:207:31
206	                    result = session.execute(
207	                        text(f"DELETE FROM {table} WHERE tenant_id = :tenant_id"),
208	                        {"tenant_id": tenant_id},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: src/dotmac_management/tests/e2e/cleanup.py:318:27
317	                cross_data_a = tenant_a_session.execute(
318	                    text(f"SELECT COUNT(*) FROM {table} WHERE tenant_id = :tenant_id"),
319	                    {"tenant_id": tenant_b_id},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: src/dotmac_management/tests/e2e/cleanup.py:331:27
330	                cross_data_b = tenant_b_session.execute(
331	                    text(f"SELECT COUNT(*) FROM {table} WHERE tenant_id = :tenant_id"),
332	                    {"tenant_id": tenant_a_id},

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to httpx with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b501_request_with_no_cert_validation.html
   Location: src/dotmac_management/tests/e2e/conftest.py:282:15
281	        timeout=30.0,
282	        verify=False,  # Ignore SSL for test environments
283	    ) as client:
284	        yield client
285	
286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:126:12
125	            # Verify scaling was logged
126	            assert mock_coolify_client.scale_application.called
127	            scale_call_args = mock_coolify_client.scale_application.call_args[1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:128:12
127	            scale_call_args = mock_coolify_client.scale_application.call_args[1]
128	            assert scale_call_args["replicas"] == 3
129	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:237:8
236	        # In real implementation, would check scaling events/logs
237	        assert (
238	            mock_coolify_client.scale_application.called or response.status_code == 200
239	        )
240	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:278:8
277	        # Verify update was called
278	        assert mock_coolify_client.update_application_resources.called
279	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:346:20
345	                    response = await http_client.get(f"{tenant_url}/health", timeout=5)
346	                    assert (
347	                        response.status_code == 200
348	                    ), f"Service unavailable during update (attempt {i+1})"
349	                except Exception as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:478:12
477	            ).scalar()
478	            assert result == 1, "Test data not inserted properly"
479	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:497:12
496	            column_names = [col[0] for col in columns]
497	            assert (
498	                "created_at" in column_names
499	            ), "Migration did not add created_at column"
500	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:505:12
504	            ).scalar()
505	            assert result == 1, "Data lost during migration"
506	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:541:12
540	            backup_result = await mock_coolify_client.create_backup(container_id)
541	            assert backup_result["backup_id"] == backup_id
542	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:553:12
552	            status = await mock_coolify_client.get_backup_status(backup_id)
553	            assert status["status"] == "completed"
554	            assert status["size_bytes"] > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:554:12
553	            assert status["status"] == "completed"
554	            assert status["size_bytes"] > 0
555	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:656:8
655	        backup_result = await mock_coolify_client.create_backup(container_id)
656	        assert backup_result["backup_id"] == backup_id
657	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:660:8
659	        verification_result = await mock_coolify_client.verify_backup(backup_id)
660	        assert verification_result["verified"] is True
661	        assert verification_result["checksum_match"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:661:8
660	        assert verification_result["verified"] is True
661	        assert verification_result["checksum_match"] is True
662	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:720:12
719	            management_db_session.refresh(tenant)
720	            assert tenant.status == TenantStatus.DEPROVISIONING
721	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:756:8
755	        # Verify no backup was created
756	        assert not mock_coolify_client.create_backup.called
757	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:789:12
788	        for task_name, _ in cleanup_tasks:
789	            assert getattr(
790	                mock_coolify_client, task_name
791	            ).called, f"Cleanup task {task_name} not called"
792	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:797:8
796	
797	        assert tenant.status == TenantStatus.DEPROVISIONED
798	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:837:12
836	            ).scalar()
837	            assert customer_count == 1, "Test customer data not created"
838	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:850:8
849	
850	        assert archive_result["status"] == "completed"
851	        assert "customers" in archive_result["tables_archived"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:851:8
850	        assert archive_result["status"] == "completed"
851	        assert "customers" in archive_result["tables_archived"]
852	        assert archive_result["size_bytes"] > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:852:8
851	        assert "customers" in archive_result["tables_archived"]
852	        assert archive_result["size_bytes"] > 0
853	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:888:16
887	                # Verify health check data
888	                assert health_response["status"] == "healthy"
889	                assert all(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:889:16
888	                assert health_response["status"] == "healthy"
889	                assert all(
890	                    service["status"] == "healthy"
891	                    for service in health_response["services"].values()
892	                )
893	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:916:8
915	        # Verify metrics were collected
916	        assert len(metrics["cpu_usage"]) > 0
917	        assert len(metrics["memory_usage"]) > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:917:8
916	        assert len(metrics["cpu_usage"]) > 0
917	        assert len(metrics["memory_usage"]) > 0
918	        assert len(metrics["timestamps"]) > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:918:8
917	        assert len(metrics["memory_usage"]) > 0
918	        assert len(metrics["timestamps"]) > 0
919	        assert len(metrics["cpu_usage"]) == len(metrics["memory_usage"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:919:8
918	        assert len(metrics["timestamps"]) > 0
919	        assert len(metrics["cpu_usage"]) == len(metrics["memory_usage"])
920	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:922:8
921	        # Verify metrics are reasonable
922	        assert all(0 <= cpu <= 100 for cpu in metrics["cpu_usage"])
923	        assert all(memory > 0 for memory in metrics["memory_usage"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:923:8
922	        assert all(0 <= cpu <= 100 for cpu in metrics["cpu_usage"])
923	        assert all(memory > 0 for memory in metrics["memory_usage"])
924	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:967:8
966	        # Verify recovery was attempted
967	        assert mock_coolify_client.restart_application.called
968	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/container_lifecycle.spec.py:971:8
970	        final_status = await mock_coolify_client.get_application_status(container_id)
971	        assert final_status["status"] == "running"

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_management/tests/e2e/run_tests.py:205:24
204	        """Check filesystem access and permissions."""
205	        temp_dir = Path("/tmp")  # noqa: B008
206	        if not temp_dir.exists() or not os.access(temp_dir, os.W_OK):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:114:16
113	
114	                assert len(tenant_a_customers) == 1
115	                assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:115:16
114	                assert len(tenant_a_customers) == 1
115	                assert (
116	                    tenant_a_customers[0].name
117	                    == tenant_a_data["test_customer_data"]["name"]
118	                )
119	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:126:16
125	
126	                assert len(tenant_b_customers) == 1
127	                assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:127:16
126	                assert len(tenant_b_customers) == 1
127	                assert (
128	                    tenant_b_customers[0].name
129	                    == tenant_b_data["test_customer_data"]["name"]
130	                )
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:138:16
137	
138	                assert (
139	                    len(cross_tenant_data) == 0
140	                ), "CRITICAL: Cross-tenant data access detected!"
141	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:210:16
209	
210	                assert tenant_a_data_check == "tenant_a_data"
211	                assert tenant_b_data_check == "tenant_b_data"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:211:16
210	                assert tenant_a_data_check == "tenant_a_data"
211	                assert tenant_b_data_check == "tenant_b_data"
212	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:218:16
217	                    tenant_b_session.execute(text("ROLLBACK"))
218	                except Exception:
219	                    pass
220	                raise e

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:295:12
294	
295	            assert tenant_a_encrypted == encrypted_data_a
296	            assert tenant_b_encrypted == encrypted_data_b

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:296:12
295	            assert tenant_a_encrypted == encrypted_data_a
296	            assert tenant_b_encrypted == encrypted_data_b
297	            assert tenant_a_encrypted != tenant_b_encrypted

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:297:12
296	            assert tenant_b_encrypted == encrypted_data_b
297	            assert tenant_a_encrypted != tenant_b_encrypted
298	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:336:8
335	        # Verify backups are isolated
336	        assert backup_a_result["backup_id"] != backup_b_result["backup_id"]
337	        assert backup_a_result["tenant_id"] != backup_b_result["tenant_id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:337:8
336	        assert backup_a_result["backup_id"] != backup_b_result["backup_id"]
337	        assert backup_a_result["tenant_id"] != backup_b_result["tenant_id"]
338	        assert backup_a_result["encrypted"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:338:8
337	        assert backup_a_result["tenant_id"] != backup_b_result["tenant_id"]
338	        assert backup_a_result["encrypted"] is True
339	        assert backup_b_result["encrypted"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:339:8
338	        assert backup_a_result["encrypted"] is True
339	        assert backup_b_result["encrypted"] is True
340	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:415:12
414	            # Should fail with 401 Unauthorized or 403 Forbidden
415	            assert response.status_code in [
416	                401,
417	                403,
418	            ], f"Cross-tenant login succeeded when it should have failed: {response.status_code}"
419	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:420:8
419	
420	        except Exception:
421	            # Network errors are acceptable as they indicate isolation
422	            pass
423	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:434:12
433	
434	            assert response.status_code in [
435	                401,
436	                403,
437	            ], f"Cross-tenant login succeeded when it should have failed: {response.status_code}"
438	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:439:8
438	
439	        except Exception:
440	            # Network errors are acceptable
441	            pass
442	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:479:12
478	
479	            assert response.status_code in [
480	                401,
481	                403,
482	            ], f"Tenant A JWT worked on Tenant B API: {response.status_code}"
483	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:484:8
483	
484	        except Exception:
485	            # Network/connection errors are acceptable
486	            pass
487	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:495:12
494	
495	            assert response.status_code in [
496	                401,
497	                403,
498	            ], f"Tenant B JWT worked on Tenant A API: {response.status_code}"
499	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:500:8
499	
500	        except Exception:
501	            # Network/connection errors are acceptable
502	            pass
503	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:534:12
533	                )
534	            except Exception:
535	                pass  # Ignore connection errors
536	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:548:8
547	
548	        except Exception:
549	            # Connection errors are acceptable in test environment
550	            pass
551	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:603:12
602	            # For now, just verify pages loaded independently
603	            assert tenant_a_theme is not None
604	            assert tenant_b_theme is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:604:12
603	            assert tenant_a_theme is not None
604	            assert tenant_b_theme is not None
605	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:676:12
675	
676	            assert tenant_a_session is not None
677	            assert tenant_b_session is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:677:12
676	            assert tenant_a_session is not None
677	            assert tenant_b_session is not None
678	            assert tenant_a_session["value"] != tenant_b_session["value"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:678:12
677	            assert tenant_b_session is not None
678	            assert tenant_a_session["value"] != tenant_b_session["value"]
679	            assert tenant_a_session["domain"] != tenant_b_session["domain"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:679:12
678	            assert tenant_a_session["value"] != tenant_b_session["value"]
679	            assert tenant_a_session["domain"] != tenant_b_session["domain"]
680	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:734:8
733	        # Verify memory isolation
734	        assert tenant_a_metrics["memory_limit"] == 2 * 1024 * 1024 * 1024
735	        assert tenant_b_metrics["memory_limit"] == 1 * 1024 * 1024 * 1024

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:735:8
734	        assert tenant_a_metrics["memory_limit"] == 2 * 1024 * 1024 * 1024
735	        assert tenant_b_metrics["memory_limit"] == 1 * 1024 * 1024 * 1024
736	        assert tenant_a_metrics["memory_limit"] != tenant_b_metrics["memory_limit"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:736:8
735	        assert tenant_b_metrics["memory_limit"] == 1 * 1024 * 1024 * 1024
736	        assert tenant_a_metrics["memory_limit"] != tenant_b_metrics["memory_limit"]
737	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:739:8
738	        # Verify tenant A's high usage doesn't affect tenant B
739	        assert tenant_b_metrics["memory_percentage"] < 60  # B still has low usage
740	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:781:8
780	        # Verify CPU isolation
781	        assert tenant_a_cpu["cpu_limit"] == 2000
782	        assert tenant_b_cpu["cpu_limit"] == 500

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:782:8
781	        assert tenant_a_cpu["cpu_limit"] == 2000
782	        assert tenant_b_cpu["cpu_limit"] == 500
783	        assert tenant_a_cpu["cpu_limit"] != tenant_b_cpu["cpu_limit"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:783:8
782	        assert tenant_b_cpu["cpu_limit"] == 500
783	        assert tenant_a_cpu["cpu_limit"] != tenant_b_cpu["cpu_limit"]
784	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:786:8
785	        # Verify tenant A's high CPU usage doesn't throttle tenant B
786	        assert tenant_b_cpu["cpu_percentage"] < 50
787	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:828:8
827	        # Verify storage isolation
828	        assert tenant_a_storage["storage_limit"] == 100 * 1024 * 1024 * 1024
829	        assert tenant_b_storage["storage_limit"] == 50 * 1024 * 1024 * 1024

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:829:8
828	        assert tenant_a_storage["storage_limit"] == 100 * 1024 * 1024 * 1024
829	        assert tenant_b_storage["storage_limit"] == 50 * 1024 * 1024 * 1024
830	        assert tenant_a_storage["used_storage"] != tenant_b_storage["used_storage"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:830:8
829	        assert tenant_b_storage["storage_limit"] == 50 * 1024 * 1024 * 1024
830	        assert tenant_a_storage["used_storage"] != tenant_b_storage["used_storage"]
831	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:833:8
832	        # Verify tenants have separate storage allocations
833	        assert tenant_a_storage["storage_limit"] != tenant_b_storage["storage_limit"]
834	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:853:8
852	        # For now, verify external URLs are different
853	        assert tenant_a_url != tenant_b_url
854	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:856:8
855	        # Verify subdomain isolation
856	        assert tenant_a.subdomain != tenant_b.subdomain
857	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:870:16
869	                # Responses should be for different tenants
870	                assert response_a.url != response_b.url
871	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:872:8
871	
872	        except Exception:
873	            # Network errors are acceptable in test environment
874	            pass
875	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:932:12
931	
932	            assert len(tenant_a_logs) == 1
933	            assert len(tenant_b_logs) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:933:12
932	            assert len(tenant_a_logs) == 1
933	            assert len(tenant_b_logs) == 1
934	            assert tenant_a_logs[0].action == "user_login"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:934:12
933	            assert len(tenant_b_logs) == 1
934	            assert tenant_a_logs[0].action == "user_login"
935	            assert tenant_b_logs[0].action == "admin_action"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:935:12
934	            assert tenant_a_logs[0].action == "user_login"
935	            assert tenant_b_logs[0].action == "admin_action"
936	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:948:12
947	
948	            assert (
949	                len(cross_logs_a) == 0
950	            ), "CRITICAL: Cross-tenant audit log access detected!"
951	            assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:951:12
950	            ), "CRITICAL: Cross-tenant audit log access detected!"
951	            assert (
952	                len(cross_logs_b) == 0
953	            ), "CRITICAL: Cross-tenant audit log access detected!"
954	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:981:8
980	        # Verify different security policies
981	        assert (
982	            tenant_a.settings["password_policy"] != tenant_b.settings["password_policy"]
983	        )
984	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:984:8
983	        )
984	        assert (
985	            tenant_a.settings["session_timeout"] != tenant_b.settings["session_timeout"]
986	        )
987	        assert tenant_a.settings["mfa_required"] != tenant_b.settings["mfa_required"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:987:8
986	        )
987	        assert tenant_a.settings["mfa_required"] != tenant_b.settings["mfa_required"]
988	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_isolation.spec.py:993:8
992	
993	        assert tenant_a.settings != tenant_b.settings

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:71:12
70	            )
71	            assert login_success, "Management admin login failed"
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:114:12
113	
114	            assert created_tenant is not None, "Tenant not found in database"
115	            assert created_tenant.status == TenantStatus.PENDING

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:115:12
114	            assert created_tenant is not None, "Tenant not found in database"
115	            assert created_tenant.status == TenantStatus.PENDING
116	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:131:12
130	
131	            assert steps_verification[
132	                "verified"
133	            ], f"Provisioning steps incomplete: {steps_verification}"
134	            assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:134:12
133	            ], f"Provisioning steps incomplete: {steps_verification}"
134	            assert (
135	                steps_verification["failed_events"] == 0
136	            ), "Provisioning had failed events"
137	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:140:12
139	            management_db_session.refresh(created_tenant)
140	            assert created_tenant.status == TenantStatus.ACTIVE
141	            assert created_tenant.domain is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:141:12
140	            assert created_tenant.status == TenantStatus.ACTIVE
141	            assert created_tenant.domain is not None
142	            assert created_tenant.container_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:142:12
141	            assert created_tenant.domain is not None
142	            assert created_tenant.container_id is not None
143	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:151:12
150	            )
151	            assert container_healthy, "Tenant container failed health checks"
152	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:155:12
154	            api_ready = await ApiTestUtils.wait_for_api_ready(tenant_url, timeout=60)
155	            assert api_ready, "Tenant API not ready"
156	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:171:16
170	                )
171	                assert tenant_login_success, "Tenant admin first login failed"
172	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:230:8
229	        )
230	        assert (
231	            duplicate_count == 1
232	        ), "Duplicate tenant was created despite validation error"
233	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:259:8
258	
259	        assert not provisioning_success, "Provisioning should have failed"
260	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:263:8
262	        management_db_session.refresh(tenant)
263	        assert tenant.status == TenantStatus.FAILED
264	        assert "Deployment quota exceeded" in tenant.settings.get("last_error", "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:264:8
263	        assert tenant.status == TenantStatus.FAILED
264	        assert "Deployment quota exceeded" in tenant.settings.get("last_error", "")
265	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:287:8
286	
287	        assert not provisioning_success
288	        management_db_session.refresh(tenant)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:289:8
288	        management_db_session.refresh(tenant)
289	        assert tenant.status == TenantStatus.FAILED
290	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:323:12
322	
323	            assert not provisioning_success
324	            management_db_session.refresh(tenant)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:325:12
324	            management_db_session.refresh(tenant)
325	            assert tenant.status == TenantStatus.FAILED
326	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:408:12
407	                pytest.fail(f"Tenant {i+1} provisioning failed: {result}")
408	            assert result is True, f"Tenant {i+1} provisioning returned False"
409	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:413:12
412	            management_db_session.refresh(tenant)
413	            assert tenant.status in [
414	                TenantStatus.ACTIVE,
415	                TenantStatus.READY,
416	            ], f"Tenant {tenant.subdomain} in wrong state: {tenant.status}"
417	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:445:8
444	
445	        assert provisioning_success, "Custom settings provisioning failed"
446	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:448:8
447	        management_db_session.refresh(tenant)
448	        assert tenant.status == TenantStatus.ACTIVE
449	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:451:8
450	        # Verify custom settings were preserved
451	        assert tenant.settings["enable_billing"] is True
452	        assert tenant.settings["max_customers"] == 1000

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:452:8
451	        assert tenant.settings["enable_billing"] is True
452	        assert tenant.settings["max_customers"] == 1000
453	        assert "advanced_reporting" in tenant.settings["features"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:453:8
452	        assert tenant.settings["max_customers"] == 1000
453	        assert "advanced_reporting" in tenant.settings["features"]
454	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:472:8
471	
472	        assert provisioning_success
473	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:484:8
483	
484	        assert len(events) > 0, "No provisioning events were logged"
485	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:499:12
498	        for expected_type in expected_event_types:
499	            assert (
500	                expected_type in logged_event_types
501	            ), f"Missing expected event type: {expected_type}"
502	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:505:8
504	        correlation_ids = set(event.correlation_id for event in events)
505	        assert len(correlation_ids) == 1, "Events should have same correlation ID"
506	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:509:12
508	        for event in events:
509	            assert event.created_at is not None
510	            assert event.step_number is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:510:12
509	            assert event.created_at is not None
510	            assert event.step_number is not None
511	            assert event.step_number > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:511:12
510	            assert event.step_number is not None
511	            assert event.step_number > 0
512	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_management_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:534:12
533	        admin_token = (
534	            "test_management_token"  # In real tests, would generate actual JWT
535	        )
536	
537	        response = await http_client.post(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:543:8
542	
543	        assert response.status_code == 201
544	        response_data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:546:8
545	
546	        assert response_data["tenant_id"] is not None
547	        assert response_data["subdomain"] == "apitest"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:547:8
546	        assert response_data["tenant_id"] is not None
547	        assert response_data["subdomain"] == "apitest"
548	        assert response_data["status"] == "pending"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:548:8
547	        assert response_data["subdomain"] == "apitest"
548	        assert response_data["status"] == "pending"
549	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:557:8
556	
557	        assert tenant is not None
558	        assert tenant.status == TenantStatus.PENDING

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:558:8
557	        assert tenant is not None
558	        assert tenant.status == TenantStatus.PENDING
559	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_management_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:571:22
570	
571	        admin_token = "test_management_token"
572	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:578:8
577	
578	        assert response.status_code == 200
579	        status_data = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:581:8
580	
581	        assert status_data["tenant_id"] == tenant.tenant_id
582	        assert status_data["status"] == "provisioning"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:582:8
581	        assert status_data["tenant_id"] == tenant.tenant_id
582	        assert status_data["status"] == "provisioning"
583	        assert status_data["subdomain"] == "statusapi"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:583:8
582	        assert status_data["status"] == "provisioning"
583	        assert status_data["subdomain"] == "statusapi"
584	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:609:8
608	        # For now, just verify tenant was created with webhook settings
609	        assert (
610	            tenant.settings["webhook_url"] == "https://test.webhook.com/tenant-events"
611	        )
612	        assert tenant.settings["enable_webhooks"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/tenant_provisioning.spec.py:612:8
611	        )
612	        assert tenant.settings["enable_webhooks"] is True

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: src/dotmac_management/tests/e2e/utils.py:74:23
73	            tenant_a_data = tenant_a_session.execute(
74	                text(f"SELECT * FROM {table_name} WHERE tenant_id = :tenant_id"),
75	                {"tenant_id": tenant_a_id},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: src/dotmac_management/tests/e2e/utils.py:81:23
80	            tenant_b_data = tenant_b_session.execute(
81	                text(f"SELECT * FROM {table_name} WHERE tenant_id = :tenant_id"),
82	                {"tenant_id": tenant_b_id},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: src/dotmac_management/tests/e2e/utils.py:88:23
87	            cross_check = tenant_b_session.execute(
88	                text(f"SELECT * FROM {table_name} WHERE tenant_id = :tenant_id"),
89	                {"tenant_id": tenant_a_id},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: src/dotmac_management/tests/e2e/utils.py:111:27
110	                session.execute(
111	                    text(f"DELETE FROM {table} WHERE tenant_id = :tenant_id"),
112	                    {"tenant_id": tenant_id},

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to httpx with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b501_request_with_no_cert_validation.html
   Location: src/dotmac_management/tests/e2e/utils.py:132:19
131	
132	        async with httpx.AsyncClient(verify=False) as client:
133	            while time.time() - start_time < timeout:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_management/tests/e2e/utils.py:184:40
183	
184	            metrics["cpu_usage"].append(random.uniform(10, 80))
185	            metrics["memory_usage"].append(random.uniform(100, 500))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_management/tests/e2e/utils.py:185:43
184	            metrics["cpu_usage"].append(random.uniform(10, 80))
185	            metrics["memory_usage"].append(random.uniform(100, 500))
186	            metrics["timestamps"].append(time.time())

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_management/tests/e2e/utils.py:250:32
249	        try:
250	            screenshot_path = f"/tmp/{test_name}_{int(time.time())}.png"
251	            await page.screenshot(path=screenshot_path, full_page=True)

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to httpx with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b501_request_with_no_cert_validation.html
   Location: src/dotmac_management/tests/e2e/utils.py:277:19
276	
277	        async with httpx.AsyncClient(verify=False) as client:
278	            while time.time() - start_time < timeout:

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to httpx with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b501_request_with_no_cert_validation.html
   Location: src/dotmac_management/tests/e2e/utils.py:298:19
297	
298	        async with httpx.AsyncClient(verify=False) as client:
299	            try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/utils.py:463:4
462	    """Assert tenant was provisioned successfully."""
463	    assert provisioning_result[
464	        "completed"
465	    ], f"Provisioning failed: {provisioning_result}"
466	    assert provisioning_result["final_status"] in [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/utils.py:466:4
465	    ], f"Provisioning failed: {provisioning_result}"
466	    assert provisioning_result["final_status"] in [
467	        TenantStatus.ACTIVE,
468	        TenantStatus.READY,
469	    ]
470	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/utils.py:474:4
473	    """Assert data isolation is maintained between tenants."""
474	    assert isolation_result["isolated"], f"Data isolation violated: {isolation_result}"
475	    assert not isolation_result[

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/utils.py:475:4
474	    assert isolation_result["isolated"], f"Data isolation violated: {isolation_result}"
475	    assert not isolation_result[
476	        "cross_contamination"
477	    ], "Cross-tenant data contamination detected"
478	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/utils.py:482:4
481	    """Assert API isolation is maintained between tenants."""
482	    assert api_result["isolated"], f"API isolation violated: {api_result}"
483	    assert not api_result["cross_tenant_access"], "Cross-tenant API access detected"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_management/tests/e2e/utils.py:483:4
482	    assert api_result["isolated"], f"API isolation violated: {api_result}"
483	    assert not api_result["cross_tenant_access"], "Cross-tenant API access detected"
484	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bearer'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/dotmac_management/user_management/api/auth_router.py:140:15
139	
140	        return LoginResponseSchema(
141	            success=True,
142	            message=result.message,
143	            access_token=result.access_token,
144	            refresh_token=result.refresh_token,
145	            token_type="bearer",  # noqa: S106 - token type label, not a secret
146	            expires_at=result.expires_at,
147	            user_id=result.user_id,
148	            session_id=result.session_id,
149	            requires_mfa=False,
150	        )
151	

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'your-jwt-secret-key'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b107_hardcoded_password_default.html
   Location: src/dotmac_management/user_management/middleware/auth_middleware.py:32:4
31	
32	    def __init__(
33	        self, app, jwt_secret: str = "your-jwt-secret-key", jwt_algorithm: str = "HS256"
34	    ):
35	        super().__init__(app)
36	        self.jwt_secret = jwt_secret
37	        self.jwt_algorithm = jwt_algorithm
38	        self.security = HTTPBearer(auto_error=False)
39	
40	        # Paths that don't require authentication
41	        self.public_paths = {
42	            "/api/v2/auth/login",
43	            "/api/v2/auth/refresh",
44	            "/api/v2/auth/mfa/verify",
45	            "/docs",
46	            "/redoc",
47	            "/openapi.json",
48	            "/health",
49	            "/metrics",
50	        }
51	
52	        # Paths that support optional authentication
53	        self.optional_auth_paths = {
54	            "/api/v1",  # Legacy API paths
55	        }
56	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'access'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_management/user_management/middleware/auth_middleware.py:139:62
138	
139	            if not user_id or not session_id or token_type != "access":
140	                raise HTTPException(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_changed'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_management/user_management/schemas/auth_schemas.py:54:23
53	    LOGOUT = "logout"
54	    PASSWORD_CHANGED = "password_changed"
55	    PASSWORD_CHANGE_FAILED = "password_change_failed"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_change_failed'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_management/user_management/schemas/auth_schemas.py:55:29
54	    PASSWORD_CHANGED = "password_changed"
55	    PASSWORD_CHANGE_FAILED = "password_change_failed"
56	    MFA_ENABLED = "mfa_enabled"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'temp_mfa'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_management/user_management/services/auth_service.py:239:29
238	
239	            if token_type != "temp_mfa":
240	                raise JWTError("Invalid token type")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'refresh'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_management/user_management/services/auth_service.py:379:29
378	
379	            if token_type != "refresh":
380	                raise JWTError("Invalid token type")

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/api/rate_limiting_decorators.py:174:8
173	                    return payload.get("sub")
174	        except Exception:
175	            pass
176	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/application/endpoints.py:182:12
181	                    ] = app.state.websocket_manager.connection_count
182	            except Exception:
183	                pass
184	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/application/endpoints.py:278:16
277	                    report["observability_status"] = obs_status
278	                except Exception:
279	                    pass
280	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/application/endpoints.py:286:16
285	                    report["health_checks"] = health_summary
286	                except Exception:
287	                    pass
288	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/business_logic/idempotency.py:562:8
561	            db.commit()
562	        except Exception:
563	            # Ignore database errors during error handling
564	            pass
565	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:63:8
62	        test_data = {"customer": {"credit_score": 650}}
63	        assert rule.evaluate(test_data) is True
64	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:67:8
66	        test_data = {"customer": {"credit_score": 550}}
67	        assert rule.evaluate(test_data) is False
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:71:8
70	        test_data = {"customer": {}}
71	        assert rule.evaluate(test_data) is False
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:107:8
106	        result = policy.evaluate(context, evaluation_data)
107	        assert result.result == PolicyResult.ALLOW
108	        assert len(result.violated_rules) == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:108:8
107	        assert result.result == PolicyResult.ALLOW
108	        assert len(result.violated_rules) == 0
109	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:113:8
112	        result = policy.evaluate(context, evaluation_data)
113	        assert result.result == PolicyResult.DENY
114	        assert "credit_score_check" in result.violated_rules

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:114:8
113	        assert result.result == PolicyResult.DENY
114	        assert "credit_score_check" in result.violated_rules
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:135:8
134	
135	        assert result["eligible"] is True
136	        assert result["plan_type"] == "residential_basic"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:136:8
135	        assert result["eligible"] is True
136	        assert result["plan_type"] == "residential_basic"
137	        assert result["policy_result"]["result"] == "allow"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:137:8
136	        assert result["plan_type"] == "residential_basic"
137	        assert result["policy_result"]["result"] == "allow"
138	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:160:8
159	
160	        assert result["eligible"] is True
161	        assert result["partner_id"] == "partner123"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:161:8
160	        assert result["eligible"] is True
161	        assert result["partner_id"] == "partner123"
162	        assert len(result["violations"]) == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:162:8
161	        assert result["partner_id"] == "partner123"
162	        assert len(result["violations"]) == 0
163	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:177:8
176	
177	        assert key.operation_type == "test_operation"
178	        assert key.tenant_id == "tenant123"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:178:8
177	        assert key.operation_type == "test_operation"
178	        assert key.tenant_id == "tenant123"
179	        assert key.key.startswith("test_operation:tenant123:")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:179:8
178	        assert key.tenant_id == "tenant123"
179	        assert key.key.startswith("test_operation:tenant123:")
180	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:188:8
187	
188	        assert key.key == key2.key
189	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:197:8
196	
197	        assert result.success is True
198	        assert result.data["result"] == "test_data"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:198:8
197	        assert result.success is True
198	        assert result.data["result"] == "test_data"
199	        assert result.execution_time_ms == 100

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:199:8
198	        assert result.data["result"] == "test_data"
199	        assert result.execution_time_ms == 100
200	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:202:8
201	        result_dict = result.to_dict()
202	        assert "success" in result_dict
203	        assert "data" in result_dict

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:203:8
202	        assert "success" in result_dict
203	        assert "data" in result_dict
204	        assert "execution_time_ms" in result_dict

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:204:8
203	        assert "data" in result_dict
204	        assert "execution_time_ms" in result_dict
205	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:297:8
296	
297	        assert result["result"] == "success"
298	        assert result["data"]["required_field"] == "value"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:298:8
297	        assert result["result"] == "success"
298	        assert result["data"]["required_field"] == "value"
299	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:317:8
316	
317	        assert error.policy_name == "test_policy"
318	        assert "rule1" in error.violated_rules

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:318:8
317	        assert error.policy_name == "test_policy"
318	        assert "rule1" in error.violated_rules
319	        assert "rule2" in error.violated_rules

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:319:8
318	        assert "rule1" in error.violated_rules
319	        assert "rule2" in error.violated_rules
320	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:322:8
321	        error_dict = error.to_dict()
322	        assert "policy_name" in error_dict["details"]
323	        assert "violated_rules" in error_dict["details"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:323:8
322	        assert "policy_name" in error_dict["details"]
323	        assert "violated_rules" in error_dict["details"]
324	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:335:8
334	
335	        assert error.provisioning_type == "tenant"
336	        assert error.target_id == "test-tenant"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:336:8
335	        assert error.provisioning_type == "tenant"
336	        assert error.target_id == "test-tenant"
337	        assert error.step_failed == "create_tenant"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:337:8
336	        assert error.target_id == "test-tenant"
337	        assert error.step_failed == "create_tenant"
338	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:340:8
339	        error_dict = error.to_dict()
340	        assert error_dict["error_code"] == "TENANT_PROVISIONING_ERROR"
341	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:353:8
352	
353	        assert error.billing_period == "2024-03"
354	        assert error.customer_count == 100

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:354:8
353	        assert error.billing_period == "2024-03"
354	        assert error.customer_count == 100
355	        assert len(error.failed_customers) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:355:8
354	        assert error.customer_count == 100
355	        assert len(error.failed_customers) == 2
356	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/test_business_logic_integration.py:358:8
357	        error_dict = error.to_dict()
358	        assert error_dict["error_code"] == "BILLING_RUN_ERROR"
359	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:127:8
126	
127	        assert test_key.startswith("test_operation:tenant123:")
128	        logger.info("   ✅ Idempotency key generation")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:190:8
189	        result = check_residential_eligibility(valid_customer)
190	        assert result["eligible"] is True
191	        logger.info("   ✅ Plan eligibility validation (passing case)")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:201:8
200	        result = check_residential_eligibility(invalid_customer)
201	        assert result["eligible"] is False
202	        assert len(result["errors"]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:202:8
201	        assert result["eligible"] is False
202	        assert len(result["errors"]) == 2
203	        logger.info("   ✅ Plan eligibility validation (failing case)")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:256:8
255	        result = calculate_commission(partner_data, Decimal("1000.00"))
256	        assert result["total_commission"] == 70.0  # 5% + 2% = 7%
257	        logger.info("   ✅ Commission calculation (with bonus)")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:262:8
261	        result = calculate_commission(partner_data, Decimal("1000.00"))
262	        assert result["total_commission"] == 50.0  # 5% only
263	        logger.info("   ✅ Commission calculation (standard)")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:304:8
303	        errors = validate_tenant_provisioning_data(valid_data)
304	        assert len(errors) == 0
305	        logger.info("   ✅ Tenant provisioning validation (valid data)")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:310:8
309	        errors = validate_tenant_provisioning_data(invalid_data)
310	        assert len(errors) > 0
311	        logger.info("   ✅ Tenant provisioning validation (invalid data)")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:342:8
341	
342	        assert policy_error.error_code == "POLICY_VIOLATION_PLAN_ELIGIBILITY"
343	        logger.info("   ✅ Policy violation error structure")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/business_logic/tests/validate_structure.py:352:8
351	
352	        assert provisioning_error.context["step_failed"] == "configure_database"
353	        logger.info("   ✅ Provisioning error structure")

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_shared/compliance/core/regulatory_reporter.py:46:28
45	    enabled_frameworks: list[ComplianceFramework]
46	    output_directory: str = "/tmp/compliance_reports"
47	    default_format: str = "pdf"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'application_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/dotmac_shared/config/secure_config.py:96:38
95	            try:
96	                secret_result = await self._adapter.get_secret(
97	                    path=path, secret_type="application_secret"
98	                )  # noqa: S106 - label for secret backend
99	                if secret_result and hasattr(secret_result, "value"):

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'application_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/dotmac_shared/config/secure_config.py:163:18
162	        try:
163	            await self._adapter.store_secret(
164	                path=path, value=value, secret_type="application_secret"
165	            )  # noqa: S106 - label for secret backend
166	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '${SECRET:database_password}'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/dotmac_shared/container_config/core/config_generator.py:257:15
256	
257	        return DatabaseConfig(
258	            host=f"db-{tenant_id}.{environment}.dotmac.io",
259	            port=5432,
260	            name=f"isp_{tenant_id}_{environment}".replace("-", "_"),
261	            username=f"isp_user_{tenant_id}".replace("-", "_")[
262	                :63
263	            ],  # PostgreSQL username limit
264	            password="${SECRET:database_password}",  # noqa: S106 - secret placeholder resolved by secret manager
265	            **base_config,
266	        )
267	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '${SECRET:redis_password}'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/dotmac_shared/container_config/core/config_generator.py:276:15
275	
276	        return RedisConfig(
277	            host=f"redis-{tenant_id}.{environment}.dotmac.io",
278	            port=6379,
279	            database=0,
280	            password="${SECRET:redis_password}",  # noqa: S106 - secret placeholder resolved by secret manager
281	            **base_config,
282	        )
283	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '${SECRET:jwt_secret_key}'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/dotmac_shared/container_config/core/config_generator.py:291:15
290	
291	        return SecurityConfig(
292	            jwt_secret_key="${SECRET:jwt_secret_key}",  # noqa: S106 - secret placeholder resolved by secret manager
293	            jwt_algorithm="RS256" if enhanced_security else "HS256",
294	            jwt_access_token_expire_minutes=15 if environment == "production" else 60,
295	            jwt_refresh_token_expire_days=30,
296	            encryption_key="${SECRET:encryption_key}",  # noqa: S106 - secret placeholder resolved by secret manager
297	            password_hash_rounds=12 if enhanced_security else 10,
298	            rate_limit_enabled=True,
299	            rate_limit_requests_per_minute=(
300	                1000 if plan == SubscriptionPlan.ENTERPRISE else 100
301	            ),
302	            cors_enabled=True,
303	            cors_origins=[f"https://{tenant_id}.dotmac.io"],
304	            enable_security_headers=True,
305	        )
306	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_shared/container_config/core/config_generator.py:354:20
353	        return {
354	            "host": "0.0.0.0",
355	            "port": 8000,
356	            "workers": worker_counts.get(plan, 2),
357	            "request_timeout": 60 if plan == SubscriptionPlan.ENTERPRISE else 30,
358	            "max_concurrent_requests": (
359	                2000 if plan == SubscriptionPlan.ENTERPRISE else 1000
360	            ),
361	            "websocket_enabled": True,
362	            "websocket_max_connections": (
363	                500 if plan == SubscriptionPlan.ENTERPRISE else 100
364	            ),
365	        }
366	
367	    async def _generate_service_configs(

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] Using jinja2 templates with autoescape=False is dangerous and can lead to XSS. Use autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b701_jinja2_autoescape_false.html
   Location: src/dotmac_shared/container_config/core/template_engine.py:102:23
101	        else:
102	            self.env = Environment(
103	                loader=FileSystemLoader(self.template_dirs),
104	                auto_reload=auto_reload,
105	                autoescape=False,  # Rendering config files (YAML/JSON), not HTML
106	                cache_size=cache_size if enable_caching else 0,
107	                trim_blocks=True,
108	                lstrip_blocks=True,
109	            )
110	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_shared/container_config/core/validators.py:291:34
290	                ipaddress.ip_address(config.host)
291	                if config.host == "0.0.0.0":
292	                    result.add_info(

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_shared/container_config/core/validators.py:298:52
297	            except ValueError:
298	                if config.host not in ["localhost", "0.0.0.0"]:
299	                    result.add_warning(

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_shared/container_config/schemas/config_schemas.py:250:30
249	    # Server settings
250	    host: str = Field(default="0.0.0.0", description="Server host")
251	    port: int = Field(default=8000, description="Server port")

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/container_monitoring/collectors/system_metrics.py:410:12
409	
410	            except Exception:
411	                pass  # Disk usage approximation is optional
412	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/container_monitoring/core/metrics_collector.py:250:12
249	                    disk_percent = disk_info.used / disk_info.total * 100
250	            except Exception:
251	                pass  # Disk metrics optional
252	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/dotmac_shared/core/settings.py:29:30
28	    # Server settings
29	    host: str = Field(default="0.0.0.0", alias="HOST")
30	    port: int = Field(default=8000, alias="PORT")

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] Using jinja2 templates with autoescape=False is dangerous and can lead to XSS. Use autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b701_jinja2_autoescape_false.html
   Location: src/dotmac_shared/database_init/core/seed_manager.py:35:25
34	        # Initialize Jinja2 environment for template rendering
35	        self.jinja_env = Environment(
36	            loader=FileSystemLoader(self.templates_path),
37	            autoescape=False,  # We're generating SQL, not HTML
38	        )
39	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_shared/deployment/ci_cd.py:354:16
353	                "--output",
354	                "/tmp/scan-results.json",
355	                image_tag,
356	            ]
357	
358	            scan_result = await self._run_command(scan_cmd)
359	
360	            result["logs"].extend(scan_result["logs"])
361	
362	            # Parse scan results
363	            if scan_result["return_code"] == 0:
364	                # Parse vulnerability data
365	                scan_data = json.loads(scan_result["stdout"])
366	                result["metrics"]["vulnerabilities"] = {
367	                    "critical": len(
368	                        [

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_shared/deployment/ci_cd.py:543:31
542	            # Remove workspace
543	            workspace_path = f"/tmp/pipeline-{run.id}"
544	            cleanup_cmd = ["rm", "-rf", workspace_path]

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_shared/deployment/ci_cd.py:559:27
558	        """Prepare workspace for pipeline execution."""
559	        workspace = Path(f"/tmp/pipeline-{run.id}")
560	        workspace.mkdir(parents=True, exist_ok=True)

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: src/dotmac_shared/deployment/ci_cd.py:657:12
656	        try:
657	            import xml.etree.ElementTree as ET
658	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: src/dotmac_shared/deployment/ci_cd.py:659:19
658	
659	            tree = ET.parse(coverage_file)
660	            root = tree.getroot()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: src/dotmac_shared/mesh/service_mesh.py:325:25
324	        hash_input = json.dumps(source_context, sort_keys=True)
325	        hash_value = int(hashlib.md5(hash_input.encode()).hexdigest(), 16)
326	        index = hash_value % len(endpoints)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/middleware/dotmac_middleware/security.py:228:12
227	                csrf_token = form_data.get("csrf_token")
228	            except Exception:
229	                pass
230	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'auth.token_refresh'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/monitoring/audit.py:31:25
30	    AUTH_FAILED = "auth.failed"
31	    AUTH_TOKEN_REFRESH = "auth.token_refresh"  # noqa: S105 - label string
32	    AUTH_PASSWORD_CHANGE = "auth.password_change"  # noqa: S105 - label string

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'auth.password_change'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/monitoring/audit.py:32:27
31	    AUTH_TOKEN_REFRESH = "auth.token_refresh"  # noqa: S105 - label string
32	    AUTH_PASSWORD_CHANGE = "auth.password_change"  # noqa: S105 - label string
33	    AUTH_MFA_ENABLED = "auth.mfa_enabled"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/monitoring/config.py:104:8
103	            return version
104	        except Exception:
105	            pass
106	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/monitoring/config.py:162:8
161	
162	        except Exception:
163	            pass
164	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_shared/operations/automation.py:308:42
307	                cache_dirs = params.get(
308	                    "cache_directories", ["/tmp/cache", "/var/cache"]
309	                )

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_shared/operations/automation.py:323:60
322	            if temp_dir_cleanup:
323	                temp_dirs = params.get("temp_directories", ["/tmp", "/var/tmp"])
324	                for temp_dir in temp_dirs:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/dotmac_shared/operations/automation.py:323:68
322	            if temp_dir_cleanup:
323	                temp_dirs = params.get("temp_directories", ["/tmp", "/var/tmp"])
324	                for temp_dir in temp_dirs:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: src/dotmac_shared/scripts/dev-setup.py:9:0
8	import platform
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b603_subprocess_without_shell_equals_true.html
   Location: src/dotmac_shared/scripts/dev-setup.py:114:12
113	        try:
114	            subprocess.run(
115	                command,
116	                cwd=cwd or self.project_root,
117	                capture_output=True,
118	                text=True,
119	                check=True,
120	            )
121	            return True

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b603_subprocess_without_shell_equals_true.html
   Location: src/dotmac_shared/scripts/dev-setup.py:146:21
145	
146	            result = subprocess.run(
147	                version_commands[tool], capture_output=True, text=True, check=True
148	            )
149	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token_abuse'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/security/api_threat_detector.py:46:18
45	    GEOGRAPHIC_ANOMALY = "geographic_anomaly"
46	    TOKEN_ABUSE = "token_abuse"
47	    API_SCRAPING = "api_scraping"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/security/connection_pool.py:105:16
104	                    )
105	                except Exception:
106	                    pass  # Ignore errors during cleanup
107	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/security/connection_pool.py:205:12
204	
205	            except Exception:
206	                pass  # Ignore cleanup errors
207	            finally:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/security/connection_pool.py:276:12
275	                session.execute(text("SELECT set_config('app.client_ip', '', false);"))
276	            except Exception:
277	                pass
278	            finally:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/security/csrf_protection.py:139:12
138	                return form_data.get("csrf_token")
139	            except Exception:
140	                pass
141	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: src/dotmac_shared/security/database_audit.py:358:28
357	                    text(
358	                        f"""
359	                    SELECT
360	                        event_type,
361	                        severity,
362	                        COUNT(*) as count,
363	                        COUNT(CASE WHEN success = false THEN 1 END) as failures
364	                    FROM database_audit_log
365	                    WHERE timestamp >= NOW() - INTERVAL '{hours} hours'
366	                    {where_clause}
367	                    GROUP BY event_type, severity
368	                    ORDER BY count DESC
369	                """
370	                    ),

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/security/tenant_middleware.py:231:12
230	                await self.rls_manager.clear_tenant_context(session)
231	            except Exception:
232	                pass  # Don't fail on cleanup
233	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/security/tenant_middleware.py:258:4
257	                return subdomain
258	    except Exception:
259	        pass
260	    return None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:50:8
49	        manager = HardenedSecretsManager(Environment.PRODUCTION)
50	        assert manager.environment == Environment.PRODUCTION
51	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:54:8
53	        manager = HardenedSecretsManager(Environment.DEVELOPMENT)
54	        assert manager.environment == Environment.DEVELOPMENT
55	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:68:8
67	        manager = HardenedSecretsManager(Environment.DEVELOPMENT, vault_client=None)
68	        assert manager.fallback_store is not None
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:88:8
87	
88	        assert secret_value == "test_secret_value"
89	        vault_client.get_secret.assert_called_with("auth", "jwt_secret_key")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_secret_value'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:88:31
87	
88	        assert secret_value == "test_secret_value"
89	        vault_client.get_secret.assert_called_with("auth", "jwt_secret_key")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:111:8
110	
111	        assert success
112	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:135:8
134	        compliance = await manager.validate_environment_compliance()
135	        assert compliance["compliant"] is True
136	        assert compliance["environment"] == "production"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:136:8
135	        assert compliance["compliant"] is True
136	        assert compliance["environment"] == "production"
137	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:141:8
140	        compliance = await manager.validate_environment_compliance()
141	        assert compliance["compliant"] is False
142	        assert "Primary OpenBao store unhealthy" in compliance["violations"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:142:8
141	        assert compliance["compliant"] is False
142	        assert "Primary OpenBao store unhealthy" in compliance["violations"]
143	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:159:12
158	            await factory.initialize(dev_context)
159	            assert factory._secrets_manager is not None
160	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:174:8
173	        secret = await factory.get_jwt_secret()
174	        assert secret == "test_jwt_secret"
175	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_jwt_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:174:25
173	        secret = await factory.get_jwt_secret()
174	        assert secret == "test_jwt_secret"
175	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:196:8
195	
196	        assert creds["password"] == "test_db_password"
197	        assert creds["username"] == "test_db_user"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:197:8
196	        assert creds["password"] == "test_db_password"
197	        assert creds["username"] == "test_db_user"
198	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:224:8
223	        admin_config = create_admin_portal_csrf_config()
224	        assert admin_config.mode == CSRFMode.HYBRID
225	        assert admin_config.portal_name == "admin"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:225:8
224	        assert admin_config.mode == CSRFMode.HYBRID
225	        assert admin_config.portal_name == "admin"
226	        assert admin_config.require_referer_check is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:226:8
225	        assert admin_config.portal_name == "admin"
226	        assert admin_config.require_referer_check is True
227	        assert admin_config.cookie_samesite == "Strict"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:227:8
226	        assert admin_config.require_referer_check is True
227	        assert admin_config.cookie_samesite == "Strict"
228	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:231:8
230	        customer_config = create_customer_portal_csrf_config()
231	        assert customer_config.mode == CSRFMode.HYBRID
232	        assert customer_config.portal_name == "customer"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:232:8
231	        assert customer_config.mode == CSRFMode.HYBRID
232	        assert customer_config.portal_name == "customer"
233	        assert customer_config.cookie_samesite == "Lax"  # More permissive

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:233:8
232	        assert customer_config.portal_name == "customer"
233	        assert customer_config.cookie_samesite == "Lax"  # More permissive
234	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:244:8
243	        token = token_generator.generate()
244	        assert len(token.split(":")) == 3  # timestamp:random:signature
245	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:248:8
247	        is_valid = token_generator.validate(token)
248	        assert is_valid is True
249	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'invalid:token:signature'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:251:24
250	        # Test invalid token
251	        invalid_token = "invalid:token:signature"
252	        is_valid = token_generator.validate(invalid_token)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:253:8
252	        is_valid = token_generator.validate(invalid_token)
253	        assert is_valid is False
254	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:272:8
271	        )
272	        assert is_valid is True
273	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:278:8
277	        )
278	        assert is_valid is False
279	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:304:12
303	            result = await middleware.dispatch(mock_request, mock_call_next)
304	            assert result == mock_response
305	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:317:8
316	
317	        assert validator.environment == Environment.PRODUCTION
318	        assert validator.portal_name == "admin"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:318:8
317	        assert validator.environment == Environment.PRODUCTION
318	        assert validator.portal_name == "admin"
319	        assert validator.requirements["secrets_management"]["vault_required"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:319:8
318	        assert validator.portal_name == "admin"
319	        assert validator.requirements["secrets_management"]["vault_required"] is True
320	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:328:8
327	        # Production should require strict security
328	        assert reqs["secrets_management"]["vault_required"] is True
329	        assert reqs["csrf_protection"]["required"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:329:8
328	        assert reqs["secrets_management"]["vault_required"] is True
329	        assert reqs["csrf_protection"]["required"] is True
330	        assert reqs["csrf_protection"]["strict_mode"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:330:8
329	        assert reqs["csrf_protection"]["required"] is True
330	        assert reqs["csrf_protection"]["strict_mode"] is True
331	        assert reqs["rate_limiting"]["required"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:331:8
330	        assert reqs["csrf_protection"]["strict_mode"] is True
331	        assert reqs["rate_limiting"]["required"] is True
332	        assert reqs["security_headers"]["required"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:332:8
331	        assert reqs["rate_limiting"]["required"] is True
332	        assert reqs["security_headers"]["required"] is True
333	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:341:8
340	        # Development should be more relaxed
341	        assert reqs["secrets_management"]["vault_required"] is False
342	        assert reqs["csrf_protection"]["required"] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:342:8
341	        assert reqs["secrets_management"]["vault_required"] is False
342	        assert reqs["csrf_protection"]["required"] is False
343	        assert reqs["rate_limiting"]["required"] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:343:8
342	        assert reqs["csrf_protection"]["required"] is False
343	        assert reqs["rate_limiting"]["required"] is False
344	        assert reqs["security_headers"]["required"] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:344:8
343	        assert reqs["rate_limiting"]["required"] is False
344	        assert reqs["security_headers"]["required"] is False
345	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:372:8
371	
372	        assert result.environment == Environment.DEVELOPMENT
373	        assert isinstance(result.security_score, float)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:373:8
372	        assert result.environment == Environment.DEVELOPMENT
373	        assert isinstance(result.security_score, float)
374	        assert result.security_score >= 0.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:374:8
373	        assert isinstance(result.security_score, float)
374	        assert result.security_score >= 0.0
375	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:390:8
389	        )
390	        assert len(critical_violations) > 0
391	        assert any("secrets manager" in v.message.lower() for v in critical_violations)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:391:8
390	        assert len(critical_violations) > 0
391	        assert any("secrets manager" in v.message.lower() for v in critical_violations)
392	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:405:12
404	
405	            assert result.environment == Environment.DEVELOPMENT
406	            assert isinstance(result.security_score, float)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:406:12
405	            assert result.environment == Environment.DEVELOPMENT
406	            assert isinstance(result.security_score, float)
407	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:438:12
437	            # Development should be compliant with relaxed requirements
438	            assert result.compliant is True or result.security_score > 50
439	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:454:12
453	            # Should have critical violations in production without proper setup
454	            assert result.has_critical_violations()
455	            assert result.security_score < 50

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:455:12
454	            assert result.has_critical_violations()
455	            assert result.security_score < 50
456	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:468:12
467	            # All should use hybrid mode for flexibility
468	            assert config.mode == CSRFMode.HYBRID
469	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:471:12
470	            # All should use both header and cookie delivery
471	            assert config.token_delivery == CSRFTokenDelivery.BOTH
472	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:474:12
473	            # Token lifetime should be reasonable (between 30 min and 4 hours)
474	            assert 1800 <= config.token_lifetime <= 14400
475	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:491:16
490	                # Production should have strictest requirements
491	                assert reqs["secrets_management"]["vault_required"] is True
492	                assert reqs["csrf_protection"]["required"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:492:16
491	                assert reqs["secrets_management"]["vault_required"] is True
492	                assert reqs["csrf_protection"]["required"] is True
493	                assert reqs["rate_limiting"]["required"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:493:16
492	                assert reqs["csrf_protection"]["required"] is True
493	                assert reqs["rate_limiting"]["required"] is True
494	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:497:16
496	                # Development should be most relaxed
497	                assert reqs["secrets_management"]["vault_required"] is False
498	                assert reqs["csrf_protection"]["required"] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:498:16
497	                assert reqs["secrets_management"]["vault_required"] is False
498	                assert reqs["csrf_protection"]["required"] is False
499	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:535:12
534	            manager = HardenedSecretsManager(Environment.DEVELOPMENT)
535	            assert secret_type in manager.DEFAULT_POLICIES
536	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/tests/test_security_integration.py:543:12
542	            config = CSRFConfig(mode=mode)
543	            assert config.mode == mode
544	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_change'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/security/unified_audit_monitor.py:46:22
45	    MFA_FAILURE = "mfa_failure"
46	    PASSWORD_CHANGE = "password_change"
47	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'missing_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/security/unified_csrf_strategy.py:39:20
38	class CSRFViolation(str, Enum):
39	    MISSING_TOKEN = "missing_token"
40	    TOKEN_MISMATCH = "token_mismatch"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token_mismatch'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/security/unified_csrf_strategy.py:40:21
39	    MISSING_TOKEN = "missing_token"
40	    TOKEN_MISMATCH = "token_mismatch"
41	    TOKEN_EXPIRED = "token_expired"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token_expired'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/security/unified_csrf_strategy.py:41:20
40	    TOKEN_MISMATCH = "token_mismatch"
41	    TOKEN_EXPIRED = "token_expired"
42	    INVALID_ORIGIN = "invalid_origin"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/security/unified_csrf_strategy.py:352:12
351	                form_token = form_data.get("csrf_token")
352	            except Exception:
353	                pass
354	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test-key-that-is-at-least-32-characters-long'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/dotmac_shared/security/validate_api_security.py:105:12
104	        try:
105	            JWTTokenValidator(
106	                secret_key="test-key-that-is-at-least-32-characters-long"
107	            )  # noqa: S106 - test value only
108	            results["passed"].append("JWT validator initialization working")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test-key-that-is-at-least-32-characters-long'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/dotmac_shared/security/validate_api_security.py:248:29
247	        try:
248	            security_suite = APISecuritySuite(
249	                environment="development",
250	                jwt_secret_key="test-key-that-is-at-least-32-characters-long",  # noqa: S106 - test value only
251	                redis_url="redis://localhost:6379",
252	            )
253	            results["passed"].append("Security suite initialization working")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:119:8
118	        dev_manager = HardenedSecretsManager(Environment.DEVELOPMENT)
119	        assert dev_manager.environment == Environment.DEVELOPMENT
120	        logger.info("   ✅ Environment detection works")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:132:12
131	        for secret_type in required_types:
132	            assert secret_type in policies
133	            policy = policies[secret_type]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:134:12
133	            policy = policies[secret_type]
134	            assert hasattr(policy, "secret_type")
135	            assert hasattr(policy, "min_length")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:135:12
134	            assert hasattr(policy, "secret_type")
135	            assert hasattr(policy, "min_length")
136	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:164:8
163	        manager = create_secrets_manager(environment="development")
164	        assert manager.environment == Environment.DEVELOPMENT
165	        logger.info("   ✅ Development secrets manager created")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:169:8
168	        compliance = await manager.validate_environment_compliance()
169	        assert isinstance(compliance, dict)
170	        assert "environment" in compliance

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:170:8
169	        assert isinstance(compliance, dict)
170	        assert "environment" in compliance
171	        assert "compliant" in compliance

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:171:8
170	        assert "environment" in compliance
171	        assert "compliant" in compliance
172	        logger.info("   ✅ Environment compliance validation works")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:208:12
207	        for portal_name, config in portal_configs:
208	            assert config.portal_name == portal_name
209	            assert isinstance(config.mode, CSRFMode)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:209:12
208	            assert config.portal_name == portal_name
209	            assert isinstance(config.mode, CSRFMode)
210	            assert isinstance(config.token_delivery, CSRFTokenDelivery)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:210:12
209	            assert isinstance(config.mode, CSRFMode)
210	            assert isinstance(config.token_delivery, CSRFTokenDelivery)
211	            assert config.token_lifetime > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:211:12
210	            assert isinstance(config.token_delivery, CSRFTokenDelivery)
211	            assert config.token_lifetime > 0
212	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:220:8
219	        token = token_generator.generate()
220	        assert isinstance(token, str)
221	        assert len(token.split(":")) == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:221:8
220	        assert isinstance(token, str)
221	        assert len(token.split(":")) == 3
222	        logger.info("   ✅ CSRF token generation works")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:226:8
225	        is_valid = token_generator.validate(token)
226	        assert is_valid is True
227	        logger.info("   ✅ CSRF token validation works")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:231:8
230	        is_valid = token_generator.validate("invalid:token:format")
231	        assert is_valid is False
232	        logger.info("   ✅ Invalid CSRF token rejection works")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:241:8
240	        )
241	        assert is_valid is True
242	        logger.info("   ✅ CSRF token binding works")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:272:12
271	            validator = EnvironmentSecurityValidator(env, portal_name="test")
272	            assert validator.environment == env
273	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:277:16
276	            if env == Environment.PRODUCTION:
277	                assert reqs["secrets_management"]["vault_required"] is True
278	                assert reqs["csrf_protection"]["required"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:278:16
277	                assert reqs["secrets_management"]["vault_required"] is True
278	                assert reqs["csrf_protection"]["required"] is True
279	            elif env == Environment.DEVELOPMENT:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:280:16
279	            elif env == Environment.DEVELOPMENT:
280	                assert reqs["secrets_management"]["vault_required"] is False
281	                assert reqs["csrf_protection"]["required"] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:281:16
280	                assert reqs["secrets_management"]["vault_required"] is False
281	                assert reqs["csrf_protection"]["required"] is False
282	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:289:8
288	
289	        assert hasattr(result, "environment")
290	        assert hasattr(result, "compliant")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:290:8
289	        assert hasattr(result, "environment")
290	        assert hasattr(result, "compliant")
291	        assert hasattr(result, "violations")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:291:8
290	        assert hasattr(result, "compliant")
291	        assert hasattr(result, "violations")
292	        assert hasattr(result, "security_score")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:292:8
291	        assert hasattr(result, "violations")
292	        assert hasattr(result, "security_score")
293	        assert isinstance(result.security_score, float)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:293:8
292	        assert hasattr(result, "security_score")
293	        assert isinstance(result.security_score, float)
294	        logger.info("   ✅ Security validation execution works")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:297:8
296	        # Test violation severity classification
297	        assert hasattr(SecuritySeverity, "CRITICAL")
298	        assert hasattr(SecuritySeverity, "HIGH")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:298:8
297	        assert hasattr(SecuritySeverity, "CRITICAL")
298	        assert hasattr(SecuritySeverity, "HIGH")
299	        assert hasattr(SecuritySeverity, "MEDIUM")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:299:8
298	        assert hasattr(SecuritySeverity, "HIGH")
299	        assert hasattr(SecuritySeverity, "MEDIUM")
300	        logger.info("   ✅ Security severity classification defined")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:320:8
319	        factory2 = HardenedSecretFactory()
320	        assert factory1 is factory2
321	        logger.info("   ✅ Singleton pattern works")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:324:8
323	        # Test factory has required methods
324	        assert hasattr(factory1, "get_jwt_secret")
325	        assert hasattr(factory1, "get_database_credentials")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:325:8
324	        assert hasattr(factory1, "get_jwt_secret")
325	        assert hasattr(factory1, "get_database_credentials")
326	        assert hasattr(factory1, "get_service_api_key")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:326:8
325	        assert hasattr(factory1, "get_database_credentials")
326	        assert hasattr(factory1, "get_service_api_key")
327	        assert hasattr(factory1, "get_encryption_key")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:327:8
326	        assert hasattr(factory1, "get_service_api_key")
327	        assert hasattr(factory1, "get_encryption_key")
328	        assert hasattr(factory1, "validate_security_compliance")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:328:8
327	        assert hasattr(factory1, "get_encryption_key")
328	        assert hasattr(factory1, "validate_security_compliance")
329	        logger.info("   ✅ Factory has required methods")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:355:12
354	
355	            assert result.environment == Environment.DEVELOPMENT
356	            assert isinstance(result.security_score, float)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:356:12
355	            assert result.environment == Environment.DEVELOPMENT
356	            assert isinstance(result.security_score, float)
357	            assert result.security_score >= 0.0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:357:12
356	            assert isinstance(result.security_score, float)
357	            assert result.security_score >= 0.0
358	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:387:12
386	            # Token lifetime should be between 30 minutes and 4 hours
387	            assert 1800 <= config.token_lifetime <= 14400
388	            # Should have reasonable path configurations

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:389:12
388	            # Should have reasonable path configurations
389	            assert len(config.excluded_paths) > 0
390	            assert len(config.api_paths) > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:390:12
389	            assert len(config.excluded_paths) > 0
390	            assert len(config.api_paths) > 0
391	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:400:12
399	            # All policies should have minimum length requirements
400	            assert policy.min_length >= 16
401	            # Rotation periods should be reasonable (between 1 day and 1 year)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:402:12
401	            # Rotation periods should be reasonable (between 1 day and 1 year)
402	            assert 1 <= policy.rotation_days <= 365
403	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/security/validate_security_implementation.py:446:12
445	            is_valid = token_generator.validate(invalid_token)
446	            assert is_valid is False
447	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: src/dotmac_shared/services/performance_optimization.py:146:15
145	            key_data += f":{json.dumps(kwargs, sort_keys=True)}"
146	        return hashlib.md5(key_data.encode()).hexdigest()
147	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: src/dotmac_shared/services/performance_optimization.py:286:24
285	        if not cache_key:
286	            cache_key = hashlib.md5(
287	                f"{query_str}:{json.dumps(params or {}, sort_keys=True)}".encode()
288	            ).hexdigest()
289	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/services/service_marketplace.py:637:15
636	
637	        return random.sample(instances, len(instances))
638	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1770:4
1769	    # Assert overall success
1770	    assert results["status"] == "completed", f"Test suite failed: {results}"
1771	    assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1771:4
1770	    assert results["status"] == "completed", f"Test suite failed: {results}"
1771	    assert (
1772	        results["summary"]["success_rate"] >= 70
1773	    ), f"Success rate too low: {results['summary']}"
1774	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1793:4
1792	
1793	    assert result["success"] is True, f"Database backup failed: {result}"
1794	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1797:4
1796	    step_names = [step["name"] for step in result["steps"]]
1797	    assert "database_seeding" in step_names
1798	    assert "full_backup_creation" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1798:4
1797	    assert "database_seeding" in step_names
1798	    assert "full_backup_creation" in step_names
1799	    assert "backup_integrity_validation" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1799:4
1798	    assert "full_backup_creation" in step_names
1799	    assert "backup_integrity_validation" in step_names
1800	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1812:4
1811	
1812	    assert result["success"] is True, f"System restore failed: {result}"
1813	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1816:4
1815	    step_names = [step["name"] for step in result["steps"]]
1816	    assert "system_backup_creation" in step_names
1817	    assert "system_restore" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1817:4
1816	    assert "system_backup_creation" in step_names
1817	    assert "system_restore" in step_names
1818	    assert "data_integrity_verification" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/backup_restore_dr_tests.py:1818:4
1817	    assert "system_restore" in step_names
1818	    assert "data_integrity_verification" in step_names
1819	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_engineering.py:107:15
106	        # Check probability
107	        return random.random() < self.probability
108	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:356:32
355	            # Let failure run for a bit
356	            await asyncio.sleep(random.uniform(1, 3))
357	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:385:32
384	
385	            await asyncio.sleep(random.uniform(2, 4))
386	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:490:25
489	            # Random chaos injection
490	            chaos_type = random.choice(
491	                [
492	                    "network_latency",
493	                    "service_failure",
494	                    "database_slowdown",
495	                    "tenant_isolation",
496	                    "isp_service",
497	                ]
498	            )
499	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:510:38
509	                        "failure_type": FailureType.NETWORK_LATENCY,
510	                        "latency_ms": random.randint(100, 1000),
511	                    }

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:515:26
514	            elif chaos_type == "service_failure":
515	                service = random.choice(list(DotMacService))
516	                experiment = ChaosExperiment(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:530:32
529	            # Let chaos run for 30-60 seconds
530	            await asyncio.sleep(random.uniform(30, 60))
531	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:583:25
582	                # Simulate various user actions
583	                action = random.choice(
584	                    [
585	                        "login",
586	                        "view_dashboard",
587	                        "check_billing",
588	                        "manage_services",
589	                        "view_reports",
590	                        "logout",
591	                    ]
592	                )
593	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:595:36
594	                # Random action duration
595	                await asyncio.sleep(random.uniform(0.5, 3.0))
596	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/chaos_scenarios.py:598:19
597	                # Small chance of user session failure
598	                if random.random() < 0.01:  # 1% failure rate
599	                    raise Exception(f"Simulated user session failure during {action}")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/testing/database/constraint_validation.py:44:11
43	
44	    PASS = "pass"
45	    FAIL = "fail"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/dotmac_shared/testing/database/data_integrity.py:47:11
46	
47	    PASS = "pass"
48	    FAIL = "fail"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:788:4
787	    # Assert overall success
788	    assert results["status"] == "completed", f"Test suite failed: {results}"
789	    assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:789:4
788	    assert results["status"] == "completed", f"Test suite failed: {results}"
789	    assert (
790	        results["summary"]["success_rate"] >= 80
791	    ), f"Success rate too low: {results['summary']}"
792	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:813:4
812	
813	    assert result["success"] is True, f"Container bootstrap failed: {result}"
814	    assert len(result["steps"]) >= 5, "Missing bootstrap steps"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:814:4
813	    assert result["success"] is True, f"Container bootstrap failed: {result}"
814	    assert len(result["steps"]) >= 5, "Missing bootstrap steps"
815	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:818:4
817	    step_names = [step["name"] for step in result["steps"]]
818	    assert "container_creation" in step_names
819	    assert "health_validation" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:819:4
818	    assert "container_creation" in step_names
819	    assert "health_validation" in step_names
820	    assert "database_migrations" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:820:4
819	    assert "health_validation" in step_names
820	    assert "database_migrations" in step_names
821	    assert "admin_bootstrap" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:821:4
820	    assert "database_migrations" in step_names
821	    assert "admin_bootstrap" in step_names
822	    assert "service_initialization" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:822:4
821	    assert "admin_bootstrap" in step_names
822	    assert "service_initialization" in step_names
823	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:836:4
835	
836	    assert result["success"] is True, f"First login flow failed: {result}"
837	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:840:4
839	    step_names = [step["name"] for step in result["steps"]]
840	    assert "first_login" in step_names
841	    assert "branding_setup" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:841:4
840	    assert "first_login" in step_names
841	    assert "branding_setup" in step_names
842	    assert "tls_provisioning" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/e2e_tenant_tests.py:842:4
841	    assert "branding_setup" in step_names
842	    assert "tls_provisioning" in step_names
843	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:31:8
30	
31	        assert tenant.id is not None
32	        assert tenant.name is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:32:8
31	        assert tenant.id is not None
32	        assert tenant.name is not None
33	        assert tenant.status == "active"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:33:8
32	        assert tenant.name is not None
33	        assert tenant.status == "active"
34	        assert tenant.created_at is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:34:8
33	        assert tenant.status == "active"
34	        assert tenant.created_at is not None
35	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:42:8
41	
42	        assert tenant.name == "Acme ISP"
43	        assert tenant.subdomain == "acme"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:43:8
42	        assert tenant.name == "Acme ISP"
43	        assert tenant.subdomain == "acme"
44	        assert tenant.plan == "enterprise"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:44:8
43	        assert tenant.subdomain == "acme"
44	        assert tenant.plan == "enterprise"
45	        assert tenant.region == "us-west-2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:45:8
44	        assert tenant.plan == "enterprise"
45	        assert tenant.region == "us-west-2"
46	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:51:8
50	
51	        assert len(tenants) == 3
52	        for tenant in tenants:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:53:12
52	        for tenant in tenants:
53	            assert tenant.plan == "professional"
54	            assert tenant.id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:54:12
53	            assert tenant.plan == "professional"
54	            assert tenant.id is not None
55	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:60:8
59	
60	        assert tenant.name == "Test Build"
61	        # This tenant is not in the factory's instances list

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:62:8
61	        # This tenant is not in the factory's instances list
62	        assert tenant not in tenant_factory.instances
63	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:88:8
87	
88	        assert service.customer_id == customer.id
89	        assert service.tenant_id == tenant_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:89:8
88	        assert service.customer_id == customer.id
89	        assert service.tenant_id == tenant_id
90	        assert service.monthly_rate == Decimal("89.99")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:90:8
89	        assert service.tenant_id == tenant_id
90	        assert service.monthly_rate == Decimal("89.99")
91	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:112:8
111	        services = [internet, phone, tv]
112	        assert len(services) == 3
113	        assert all(s.customer_id == customer.id for s in services)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:113:8
112	        assert len(services) == 3
113	        assert all(s.customer_id == customer.id for s in services)
114	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:144:8
143	
144	        assert account.customer_id == customer.id
145	        assert invoice.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:145:8
144	        assert account.customer_id == customer.id
145	        assert invoice.customer_id == customer.id
146	        assert payment.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:146:8
145	        assert invoice.customer_id == customer.id
146	        assert payment.customer_id == customer.id
147	        assert payment.invoice_id == invoice.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:147:8
146	        assert payment.customer_id == customer.id
147	        assert payment.invoice_id == invoice.id
148	        assert payment.amount == invoice.total_amount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:148:8
147	        assert payment.invoice_id == invoice.id
148	        assert payment.amount == invoice.total_amount
149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:162:8
161	        # Verify customers belong to correct tenants
162	        assert customer_a.tenant_id == tenant_a.id
163	        assert customer_b.tenant_id == tenant_b.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:163:8
162	        assert customer_a.tenant_id == tenant_a.id
163	        assert customer_b.tenant_id == tenant_b.id
164	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:166:8
165	        # Verify tenant isolation
166	        assert customer_a.tenant_id != customer_b.tenant_id
167	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:184:8
183	        # The service should be in tenant A context, not customer B's tenant
184	        assert service.tenant_id == tenant_a.id
185	        assert service.customer_id == customer_b.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:185:8
184	        assert service.tenant_id == tenant_a.id
185	        assert service.customer_id == customer_b.id
186	        # In a real implementation, this would trigger validation errors

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:205:8
204	
205	        assert customer.name == "Builder Customer"
206	        assert customer.type == "business"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:206:8
205	        assert customer.name == "Builder Customer"
206	        assert customer.type == "business"
207	        assert "@" in customer.email

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:207:8
206	        assert customer.type == "business"
207	        assert "@" in customer.email
208	        assert customer.phone is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:208:8
207	        assert "@" in customer.email
208	        assert customer.phone is not None
209	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:225:8
224	        # Should have 1 customer and 2 services
225	        assert "parent_customer_services" in result
226	        assert "child_customer_services_0" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:226:8
225	        assert "parent_customer_services" in result
226	        assert "child_customer_services_0" in result
227	        assert "child_customer_services_1" in result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:227:8
226	        assert "child_customer_services_0" in result
227	        assert "child_customer_services_1" in result
228	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:233:8
232	
233	        assert service1.customer_id == customer.id
234	        assert service2.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:234:8
233	        assert service1.customer_id == customer.id
234	        assert service2.customer_id == customer.id
235	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:247:8
246	
247	        assert "customer" in context.entities
248	        assert "service" in context.entities

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:248:8
247	        assert "customer" in context.entities
248	        assert "service" in context.entities
249	        assert "billing_account" in context.entities

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:249:8
248	        assert "service" in context.entities
249	        assert "billing_account" in context.entities
250	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:254:8
253	
254	        assert service.customer_id == customer.id
255	        assert customer.tenant_id == "test-tenant-123"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:255:8
254	        assert service.customer_id == customer.id
255	        assert customer.tenant_id == "test-tenant-123"
256	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:271:8
270	
271	        assert isinstance(name, str)
272	        assert "@" in email

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:272:8
271	        assert isinstance(name, str)
272	        assert "@" in email
273	        assert isinstance(company, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:273:8
272	        assert "@" in email
273	        assert isinstance(company, str)
274	        assert "." in ip_addr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:274:8
273	        assert isinstance(company, str)
274	        assert "." in ip_addr
275	        assert ":" in mac_addr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:275:8
274	        assert "." in ip_addr
275	        assert ":" in mac_addr
276	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:283:8
282	
283	        assert seq1 == 1
284	        assert seq2 == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:284:8
283	        assert seq1 == 1
284	        assert seq2 == 2
285	        assert seq3 == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:285:8
284	        assert seq2 == 2
285	        assert seq3 == 3
286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:301:8
300	
301	        assert "name" in data
302	        assert "@" in data["email"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:302:8
301	        assert "name" in data
302	        assert "@" in data["email"]
303	        assert 18 <= data["age"] <= 65

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:303:8
302	        assert "@" in data["email"]
303	        assert 18 <= data["age"] <= 65
304	        assert isinstance(data["is_active"], bool)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:304:8
303	        assert 18 <= data["age"] <= 65
304	        assert isinstance(data["is_active"], bool)
305	        assert data["company"] == "Fixed Company Name"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:305:8
304	        assert isinstance(data["is_active"], bool)
305	        assert data["company"] == "Fixed Company Name"
306	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:319:8
318	
319	        assert len(customers) == 50
320	        assert all(c.tenant_id == tenant_id for c in customers)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:320:8
319	        assert len(customers) == 50
320	        assert all(c.tenant_id == tenant_id for c in customers)
321	        assert len({c.email for c in customers}) == 50  # All unique emails

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:321:8
320	        assert all(c.tenant_id == tenant_id for c in customers)
321	        assert len({c.email for c in customers}) == 50  # All unique emails
322	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:329:8
328	        # Verify bulk creation succeeded
329	        assert tenant is not None
330	        assert len(customers) == 100

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:330:8
329	        assert tenant is not None
330	        assert len(customers) == 100
331	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:333:8
332	        # All customers should be in same tenant
333	        assert all(c.tenant_id == tenant.id for c in customers)
334	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:347:8
346	        # Verify complete setup
347	        assert customer is not None
348	        assert service.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:348:8
347	        assert customer is not None
348	        assert service.customer_id == customer.id
349	        assert invoice.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:349:8
348	        assert service.customer_id == customer.id
349	        assert invoice.customer_id == customer.id
350	        assert router.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:350:8
349	        assert invoice.customer_id == customer.id
350	        assert router.customer_id == customer.id
351	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:369:8
368	
369	        assert ticket.customer_id == customer.id
370	        assert ticket.status == "open"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:370:8
369	        assert ticket.customer_id == customer.id
370	        assert ticket.status == "open"
371	        assert ticket.category == "technical"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:371:8
370	        assert ticket.status == "open"
371	        assert ticket.category == "technical"
372	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:422:8
421	
422	        assert service.service_type == "custom"
423	        assert service.custom_field == "specialized_value"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:423:8
422	        assert service.service_type == "custom"
423	        assert service.custom_field == "specialized_value"
424	        assert service.status == "active"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/examples.py:424:8
423	        assert service.custom_field == "specialized_value"
424	        assert service.status == "active"
425	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: src/dotmac_shared/testing/frontend_flows.py:254:16
253	                        found_elements.append(selector)
254	                except Exception:
255	                    # Element not found or not accessible - skip and continue
256	                    continue
257	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/frontend_flows.py:452:4
451	    # Assert based on DRY success criteria
452	    assert result["success"], f"Frontend flows failed: {result['metrics']}"
453	    assert result["metrics"]["total_tests"] > 0, "No frontend tests executed"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/frontend_flows.py:453:4
452	    assert result["success"], f"Frontend flows failed: {result['metrics']}"
453	    assert result["metrics"]["total_tests"] > 0, "No frontend tests executed"
454	    assert len(result["applications"]) >= 2, "Insufficient applications tested"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/frontend_flows.py:454:4
453	    assert result["metrics"]["total_tests"] > 0, "No frontend tests executed"
454	    assert len(result["applications"]) >= 2, "Insufficient applications tested"
455	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:182:16
181	            DataType.STRING: lambda: "".join(
182	                random.choices(
183	                    string.ascii_letters + string.digits, k=kwargs.get("length", 10)
184	                )
185	            ),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:187:38
186	            DataType.UUID: lambda: str(uuid4()),
187	            DataType.INTEGER: lambda: random.randint(
188	                kwargs.get("min", 1), kwargs.get("max", 1000)
189	            ),
190	            DataType.BOOLEAN: lambda: random.choice([True, False]),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:190:38
189	            ),
190	            DataType.BOOLEAN: lambda: random.choice([True, False]),
191	            DataType.EMAIL: lambda: f"user{random.randint(1000, 9999)}@example.com",

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:191:43
190	            DataType.BOOLEAN: lambda: random.choice([True, False]),
191	            DataType.EMAIL: lambda: f"user{random.randint(1000, 9999)}@example.com",
192	            DataType.DATETIME: lambda: utc_now()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:193:29
192	            DataType.DATETIME: lambda: utc_now()
193	            - timedelta(days=random.randint(0, 365)),
194	        }

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:262:20
261	                    10,
262	                    random.randint(0, 255),
263	                    random.randint(0, 255),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:263:20
262	                    random.randint(0, 255),
263	                    random.randint(0, 255),
264	                    random.randint(1, 254),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:264:20
263	                    random.randint(0, 255),
264	                    random.randint(1, 254),
265	                ),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:268:20
267	                    172,
268	                    random.randint(16, 31),
269	                    random.randint(0, 255),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:269:20
268	                    random.randint(16, 31),
269	                    random.randint(0, 255),
270	                    random.randint(1, 254),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:270:20
269	                    random.randint(0, 255),
270	                    random.randint(1, 254),
271	                ),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:272:27
271	                ),
272	                (192, 168, random.randint(0, 255), random.randint(1, 254)),
273	            ]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:272:51
271	                ),
272	                (192, 168, random.randint(0, 255), random.randint(1, 254)),
273	            ]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:274:37
273	            ]
274	            return ".".join(map(str, random.choice(ranges)))
275	        elif ip_type == "public":

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:278:26
277	            while True:
278	                octets = [random.randint(1, 223) for _ in range(4)]
279	                ip = ".".join(map(str, octets))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:284:32
283	            # Random IP
284	            return ".".join(str(random.randint(1, 254)) for _ in range(4))
285	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:298:34
297	            prefix = vendor_prefixes.get(vendor.lower(), "00:00:00")
298	            suffix = ":".join([f"{random.randint(0, 255):02X}" for _ in range(3)])
299	            return f"{prefix}:{suffix}"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:302:32
301	            # Random MAC
302	            return ":".join([f"{random.randint(0, 255):02X}" for _ in range(6)])
303	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:306:22
305	        """Generate service ID in ISP format."""
306	        return f"SRV-{random.randint(100000, 999999)}"
307	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/generators.py:310:23
309	        """Generate customer number in ISP format."""
310	        return f"CUST-{random.randint(10000, 99999)}"
311	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/integration_base.py:116:8
115	
116	        assert len(events) == len(
117	            expected_events
118	        ), f"Expected {len(expected_events)} events, got {len(events)}"
119	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:949:26
948	                # Mock recovery success based on success rate
949	                success = random.random() < workflow["success_rate"]
950	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:1407:41
1406	                        datetime.now(timezone.utc)
1407	                        - timedelta(days=random.randint(1, 30))
1408	                    ).isoformat(),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:1411:41
1410	                        datetime.now(timezone.utc)
1411	                        - timedelta(days=random.randint(1, 30))
1412	                    ).isoformat(),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:1840:26
1839	                # Mock reversal success based on probability
1840	                success = random.random() < scenario["success_probability"]
1841	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2638:4
2637	    # Assert overall success
2638	    assert results["status"] == "completed", f"Test suite failed: {results}"
2639	    assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2639:4
2638	    assert results["status"] == "completed", f"Test suite failed: {results}"
2639	    assert (
2640	        results["summary"]["success_rate"] >= 75
2641	    ), f"Success rate too low: {results['summary']}"
2642	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2662:4
2661	
2662	    assert result["success"] is True, f"Payment declines test failed: {result}"
2663	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2666:4
2665	    step_names = [step["name"] for step in result["steps"]]
2666	    assert "customer_payment_setup" in step_names
2667	    assert "decline_scenarios_testing" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2667:4
2666	    assert "customer_payment_setup" in step_names
2667	    assert "decline_scenarios_testing" in step_names
2668	    assert "retry_logic_testing" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2668:4
2667	    assert "decline_scenarios_testing" in step_names
2668	    assert "retry_logic_testing" in step_names
2669	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2681:4
2680	
2681	    assert result["success"] is True, f"Refund edge cases test failed: {result}"
2682	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2685:4
2684	    step_names = [step["name"] for step in result["steps"]]
2685	    assert "refund_payment_setup" in step_names
2686	    assert "partial_refund_test" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2686:4
2685	    assert "refund_payment_setup" in step_names
2686	    assert "partial_refund_test" in step_names
2687	    assert "cross_tenant_isolation_test" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/payments_edge_cases_tests.py:2687:4
2686	    assert "partial_refund_test" in step_names
2687	    assert "cross_tenant_isolation_test" in step_names
2688	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/testing/reliability_tester.py:253:12
252	                results["degraded_functionality"] = True
253	            except Exception:
254	                # Complete failure
255	                pass
256	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/secrets_config_tests.py:1488:4
1487	    # Assert overall success
1488	    assert results["status"] == "completed", f"Test suite failed: {results}"
1489	    assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/secrets_config_tests.py:1489:4
1488	    assert results["status"] == "completed", f"Test suite failed: {results}"
1489	    assert (
1490	        results["summary"]["success_rate"] >= 75
1491	    ), f"Success rate too low: {results['summary']}"
1492	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/secrets_config_tests.py:1511:4
1510	
1511	    assert result["success"] is True, f"JWT rotation failed: {result}"
1512	    assert len(result["steps"]) >= 6, "Missing JWT rotation steps"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/secrets_config_tests.py:1512:4
1511	    assert result["success"] is True, f"JWT rotation failed: {result}"
1512	    assert len(result["steps"]) >= 6, "Missing JWT rotation steps"
1513	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/secrets_config_tests.py:1525:4
1524	
1525	    assert result["success"] is True, f"Config drift detection failed: {result}"
1526	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/secrets_config_tests.py:1529:4
1528	    step_names = [step["name"] for step in result["steps"]]
1529	    assert "baseline_creation" in step_names
1530	    assert "drift_detection" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/secrets_config_tests.py:1530:4
1529	    assert "baseline_creation" in step_names
1530	    assert "drift_detection" in step_names
1531	    assert "drift_reporting" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/secrets_config_tests.py:1531:4
1530	    assert "drift_detection" in step_names
1531	    assert "drift_reporting" in step_names
1532	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:35:8
34	        # Verify factories are registered
35	        assert "tenant_factory" in factory_registry.factories
36	        assert "customer_factory" in factory_registry.factories

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:36:8
35	        assert "tenant_factory" in factory_registry.factories
36	        assert "customer_factory" in factory_registry.factories
37	        assert "service_factory" in factory_registry.factories

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:37:8
36	        assert "customer_factory" in factory_registry.factories
37	        assert "service_factory" in factory_registry.factories
38	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:41:8
40	        tenant_factory = factory_registry.get_factory("tenant_factory")
41	        assert tenant_factory is not None
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:48:8
47	
48	        assert tenant.name == "Integration Test ISP"
49	        assert tenant.id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:49:8
48	        assert tenant.name == "Integration Test ISP"
49	        assert tenant.id is not None
50	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:70:8
69	        # Verify relationship
70	        assert service.customer_id == customer.id
71	        assert service.tenant_id == tenant_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:71:8
70	        assert service.customer_id == customer.id
71	        assert service.tenant_id == tenant_id
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:81:8
80	        # Verify proper isolation
81	        assert customer_a.tenant_id == tenant_a.id
82	        assert customer_b.tenant_id == tenant_b.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:82:8
81	        assert customer_a.tenant_id == tenant_a.id
82	        assert customer_b.tenant_id == tenant_b.id
83	        assert customer_a.tenant_id != customer_b.tenant_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:83:8
82	        assert customer_b.tenant_id == tenant_b.id
83	        assert customer_a.tenant_id != customer_b.tenant_id
84	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:86:8
85	        # Verify tenant data integrity
86	        assert tenant_a.id != tenant_b.id
87	        assert tenant_a.name != tenant_b.name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:87:8
86	        assert tenant_a.id != tenant_b.id
87	        assert tenant_a.name != tenant_b.name
88	        assert tenant_a.subdomain != tenant_b.subdomain

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:88:8
87	        assert tenant_a.name != tenant_b.name
88	        assert tenant_a.subdomain != tenant_b.subdomain
89	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:106:8
105	
106	        assert customer.name == name
107	        assert customer.email == email

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:107:8
106	        assert customer.name == name
107	        assert customer.email == email
108	        assert customer.company_name == company

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:108:8
107	        assert customer.email == email
108	        assert customer.company_name == company
109	        assert customer.type == "business"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:109:8
108	        assert customer.company_name == company
109	        assert customer.type == "business"
110	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:117:8
116	
117	        assert "." in private_ip
118	        assert "." in public_ip

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:118:8
117	        assert "." in private_ip
118	        assert "." in public_ip
119	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:122:8
121	        first_octet = int(private_ip.split(".")[0])
122	        assert first_octet in [10, 172, 192]
123	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:128:8
127	
128	        assert ":" in cisco_mac
129	        assert ":" in mikrotik_mac

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:129:8
128	        assert ":" in cisco_mac
129	        assert ":" in mikrotik_mac
130	        assert len(cisco_mac.split(":")) == 6

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:130:8
129	        assert ":" in mikrotik_mac
130	        assert len(cisco_mac.split(":")) == 6
131	        assert len(mikrotik_mac.split(":")) == 6

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:131:8
130	        assert len(cisco_mac.split(":")) == 6
131	        assert len(mikrotik_mac.split(":")) == 6
132	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:142:8
141	        # Verify customer sequences
142	        assert customer_sequences == [1, 2, 3, 4, 5]
143	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:145:8
144	        # Verify invoice sequences
145	        assert invoice_sequences == [1, 2, 3]
146	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:149:8
148	        more_customer = data_generator.next_sequence("customer")
149	        assert more_customer == 6  # Continues from last customer sequence
150	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:165:8
164	
165	        assert customer.name == "Builder Test Customer"
166	        assert customer.type == "business"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:166:8
165	        assert customer.name == "Builder Test Customer"
166	        assert customer.type == "business"
167	        assert "@" in customer.email

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:167:8
166	        assert customer.type == "business"
167	        assert "@" in customer.email
168	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:209:8
208	
209	        assert service1.customer_id == customer.id
210	        assert service2.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:210:8
209	        assert service1.customer_id == customer.id
210	        assert service2.customer_id == customer.id
211	        assert service1.service_type == "internet"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:211:8
210	        assert service2.customer_id == customer.id
211	        assert service1.service_type == "internet"
212	        assert service2.service_type == "phone"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:212:8
211	        assert service1.service_type == "internet"
212	        assert service2.service_type == "phone"
213	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:224:8
223	        # Verify scenario entities
224	        assert "customer" in context.entities
225	        assert "service" in context.entities

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:225:8
224	        assert "customer" in context.entities
225	        assert "service" in context.entities
226	        assert "billing_account" in context.entities

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:226:8
225	        assert "service" in context.entities
226	        assert "billing_account" in context.entities
227	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:233:8
232	        # Verify relationships
233	        assert service.customer_id == customer.id
234	        assert billing.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:234:8
233	        assert service.customer_id == customer.id
234	        assert billing.customer_id == customer.id
235	        assert service.service_type == "fiber"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:235:8
234	        assert billing.customer_id == customer.id
235	        assert service.service_type == "fiber"
236	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:250:8
249	
250	        assert customer.tenant_id == tenant.id
251	        assert customer.name == "Fixture Test Customer"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:251:8
250	        assert customer.tenant_id == tenant.id
251	        assert customer.name == "Fixture Test Customer"
252	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:258:12
257	        for key in required_keys:
258	            assert key in customer_with_service
259	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:265:8
264	        # Verify relationships and data integrity
265	        assert service.customer_id == customer.id
266	        assert customer.tenant_id == tenant_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:266:8
265	        assert service.customer_id == customer.id
266	        assert customer.tenant_id == tenant_id
267	        assert service.tenant_id == tenant_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:267:8
266	        assert customer.tenant_id == tenant_id
267	        assert service.tenant_id == tenant_id
268	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:281:12
280	        for entity_name in expected_entities:
281	            assert entity_name in complete_customer_scenario
282	            entity = complete_customer_scenario[entity_name]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:283:12
282	            entity = complete_customer_scenario[entity_name]
283	            assert entity is not None
284	            assert hasattr(entity, "id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:284:12
283	            assert entity is not None
284	            assert hasattr(entity, "id")
285	            assert entity.id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:285:12
284	            assert hasattr(entity, "id")
285	            assert entity.id is not None
286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:302:8
301	        # Verify results
302	        assert len(customers) == 50
303	        assert duration < 5.0  # Should complete quickly

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:303:8
302	        assert len(customers) == 50
303	        assert duration < 5.0  # Should complete quickly
304	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:307:8
306	        customer_ids = [c.id for c in customers]
307	        assert len(set(customer_ids)) == 50
308	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:310:8
309	        # Verify all customers belong to correct tenant
310	        assert all(c.tenant_id == tenant_id for c in customers)
311	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:323:8
322	        # Verify instances are tracked
323	        assert len(tenant_factory.instances) == 1
324	        assert len(customer_factory.instances) == 10

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:324:8
323	        assert len(tenant_factory.instances) == 1
324	        assert len(customer_factory.instances) == 10
325	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:328:8
327	        customer_factory.cleanup()
328	        assert len(customer_factory.instances) == 0
329	        assert len(tenant_factory.instances) == 1  # Should not be affected

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:329:8
328	        assert len(customer_factory.instances) == 0
329	        assert len(tenant_factory.instances) == 1  # Should not be affected
330	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:333:8
332	        factory_registry.cleanup_all()
333	        assert len(tenant_factory.instances) == 0
334	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:342:12
341	            customers = customer_factory.create_batch(count=20)
342	            assert len(customers) == 20
343	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:345:12
344	            customer_factory.cleanup()
345	            assert len(customer_factory.instances) == 0
346	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:348:8
347	        # Should not accumulate memory or state
348	        assert len(customer_factory._relationships) == 0
349	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:375:8
374	        # Factory should still create entity (validation is application-specific)
375	        assert customer.id is not None
376	        assert customer.name == ""

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:376:8
375	        assert customer.id is not None
376	        assert customer.name == ""
377	        assert customer.email == "invalid-email"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:377:8
376	        assert customer.name == ""
377	        assert customer.email == "invalid-email"
378	        assert customer.type == "invalid_type"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:378:8
377	        assert customer.email == "invalid-email"
378	        assert customer.type == "invalid_type"
379	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:420:8
419	
420	        assert entity.custom_field == "modified_value"
421	        assert entity.created_by == "custom_factory"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:421:8
420	        assert entity.custom_field == "modified_value"
421	        assert entity.created_by == "custom_factory"
422	        assert entity.id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:422:8
421	        assert entity.created_by == "custom_factory"
422	        assert entity.id is not None
423	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:443:8
442	        value = data_generator.generate(DataType.STRING, pattern="test_pattern")
443	        assert value == "CUSTOM-TEST-VALUE"
444	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:492:8
491	        # Verify complete integration
492	        assert tenant.id is not None
493	        assert customer.tenant_id == tenant.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:493:8
492	        assert tenant.id is not None
493	        assert customer.tenant_id == tenant.id
494	        assert service.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:494:8
493	        assert customer.tenant_id == tenant.id
494	        assert service.customer_id == customer.id
495	        assert service.tenant_id == tenant.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:495:8
494	        assert service.customer_id == customer.id
495	        assert service.tenant_id == tenant.id
496	        assert invoice.customer_id == customer.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:496:8
495	        assert service.tenant_id == tenant.id
496	        assert invoice.customer_id == customer.id
497	        assert invoice.total_amount == Decimal("99.99")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/test_factory_integration.py:497:8
496	        assert invoice.customer_id == customer.id
497	        assert invoice.total_amount == Decimal("99.99")
498	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2181:4
2180	    # Assert overall success
2181	    assert results["status"] == "completed", f"Test suite failed: {results}"
2182	    assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2182:4
2181	    assert results["status"] == "completed", f"Test suite failed: {results}"
2182	    assert (
2183	        results["summary"]["success_rate"] >= 75
2184	    ), f"Success rate too low: {results['summary']}"
2185	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2204:4
2203	
2204	    assert result["success"] is True, f"Blue/green deployment failed: {result}"
2205	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2208:4
2207	    step_names = [step["name"] for step in result["steps"]]
2208	    assert "blue_environment_setup" in step_names
2209	    assert "green_environment_deployment" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2209:4
2208	    assert "blue_environment_setup" in step_names
2209	    assert "green_environment_deployment" in step_names
2210	    assert "traffic_switching" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2210:4
2209	    assert "green_environment_deployment" in step_names
2210	    assert "traffic_switching" in step_names
2211	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2222:4
2221	
2222	    assert result["success"] is True, f"Schema migrations failed: {result}"
2223	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2226:4
2225	    step_names = [step["name"] for step in result["steps"]]
2226	    assert "baseline_schema_setup" in step_names
2227	    assert "forward_migrations_application" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2227:4
2226	    assert "baseline_schema_setup" in step_names
2227	    assert "forward_migrations_application" in step_names
2228	    assert "rollback_migrations_application" in step_names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/testing/upgrade_migration_tests.py:2228:4
2227	    assert "forward_migrations_application" in step_names
2228	    assert "rollback_migrations_application" in step_names
2229	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:74:8
73	
74	        assert (
75	            error_element is not None
76	        ), f"License limit error not found for {limit_type}"
77	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:82:8
81	
82	        assert (
83	            expected_text.lower() in error_text.lower()
84	        ), f"Error message should contain '{expected_text}', got: {error_text}"
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:87:12
86	        if expected_limit:
87	            assert (
88	                str(expected_limit) in error_text
89	            ), f"Error message should contain limit value '{expected_limit}', got: {error_text}"
90	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:107:8
106	        actual_enabled = response.get("enabled", False)
107	        assert (
108	            actual_enabled == expected_enabled
109	        ), f"Feature '{feature_name}' should be {expected_enabled}, but got {actual_enabled}"
110	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:136:8
135	        plan_text = await plan_indicator.text_content()
136	        assert (
137	            expected_plan.lower() in plan_text.lower()
138	        ), f"Expected plan '{expected_plan}' not found in: {plan_text}"
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:192:8
191	
192	        assert grace_element is not None, "Grace period indicator not found"
193	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:195:8
194	        grace_text = await grace_element.text_content()
195	        assert (
196	            "grace period" in grace_text.lower()
197	        ), f"Grace period text not found in: {grace_text}"
198	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:205:12
204	            )
205	            assert (
206	                time_found
207	            ), f"Grace period time not indicated properly in: {grace_text}"
208	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:228:8
227	
228	        assert (
229	            len(failed_apps) == 0
230	        ), f"Feature '{feature_name}' state inconsistent across apps. Failed: {failed_apps}"
231	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:263:20
262	                    # Should be within specified minutes
263	                    assert (
264	                        "minute" in timestamp_text or "second" in timestamp_text
265	                    ), f"Audit entry should be recent, got: {timestamp_text}"
266	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:269:8
268	
269	        assert (
270	            matching_entry_found
271	        ), f"Audit log entry for '{action_type}' not found for tenant {tenant_id}"
272	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:288:12
287	        if expected_count is not None:
288	            assert (
289	                str(expected_count) in usage_text
290	            ), f"Usage count {expected_count} not found in: {usage_text}"
291	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:298:12
297	            percentage_text = await usage_percentage.text_content()
298	            assert (
299	                "%" in percentage_text
300	            ), f"Usage percentage should be displayed: {percentage_text}"
301	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:354:8
353	
354	        assert feature_update_found, f"Real-time update for {feature_name} not received"
355	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:380:8
379	
380	        assert (
381	            response_time <= max_response_time_ms
382	        ), f"Feature check for '{feature_name}' took {response_time}ms, expected <= {max_response_time_ms}ms"
383	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/assertions.py:399:8
398	        actual_hit_ratio = cache_stats.get("hit_ratio", 0)
399	        assert (
400	            actual_hit_ratio >= cache_hit_ratio
401	        ), f"License cache hit ratio {actual_hit_ratio} below expected {cache_hit_ratio}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/helpers.py:128:8
127	
128	        assert (
129	            response.get("enabled") == expected_state
130	        ), f"Feature {feature_name} should be {expected_state}, but got {response.get('enabled')}"
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/helpers.py:237:8
236	        grace_text = await grace_notice.text_content()
237	        assert (
238	            "grace period" in grace_text.lower()
239	        ), "Grace period notice should be displayed"
240	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/helpers.py:261:8
260	
261	        assert matching_entry is not None, f"Audit entry for {action_type} not found"
262	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/helpers.py:268:8
267	        # Should contain timestamp, action, and tenant info
268	        assert tenant_id in entry_text
269	        assert action_type in entry_text

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/dotmac_shared/tests/e2e/licensing/helpers.py:269:8
268	        assert tenant_id in entry_text
269	        assert action_type in entry_text
270	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/dotmac_shared/workflows/base.py:279:16
278	                        pass
279	                except Exception:
280	                    # Log rollback error but continue with other rollbacks
281	                    pass
282	

--------------------------------------------------

Code scanned:
	Total lines of code: 214950
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 944
		Medium: 30
		High: 11
	Total issues (by confidence):
		Undefined: 0
		Low: 8
		Medium: 57
		High: 920
Files skipped (0):
