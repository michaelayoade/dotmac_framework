[pytest]
# E2E Test Configuration for DotMac Management Backend

# Test Discovery
testpaths = src/dotmac_management/tests/e2e
python_files = *.spec.py
python_classes = Test*
python_functions = test_*

# Test Output and Reporting
addopts = 
    --strict-markers
    --tb=short
    --verbose
    --color=yes
    --durations=20
    --capture=no
    --show-capture=all

# Test Markers
markers =
    e2e: End-to-end tests
    tenant_provisioning: Tenant provisioning workflow tests
    container_lifecycle: Container lifecycle management tests
    tenant_isolation: Multi-tenant isolation tests
    slow: Tests that take more than 30 seconds
    integration: Integration tests with external services
    requires_containers: Tests that require container orchestration
    requires_databases: Tests that require database connections
    cleanup_critical: Tests that must have cleanup validation

# Async Test Configuration
asyncio_mode = auto

# Test Selection Filters
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore:.*unclosed.*:ResourceWarning

# Minimum version requirements
minversion = 7.0

# Test timeout (in seconds)
timeout = 1800  # 30 minutes for slow E2E tests

# Parallel execution settings
# Use with: pytest -n auto (requires pytest-xdist)
# Disable for debugging: pytest -n 0

# Coverage settings (if enabled)
# Use with: pytest --cov=src/dotmac_management --cov-report=html
# addopts = --cov=src/dotmac_management --cov-report=term-missing --cov-report=html